var e=Object.defineProperty,__publicField=(t,n,s)=>((t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s)(t,"symbol"!=typeof n?n+"":n,s);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&processPreload(e)})).observe(document,{childList:!0,subtree:!0})}function processPreload(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t=(e=>(e.INITIAL="initial",e.STORES_PAGE="stores-page",e.REGISTER_FORM="register-form",e.REGISTER_EXTENDED_FORM="register-extended-form",e.LOGIN_FORM="login-form",e.IN_OTP_FORM="otp-form",e.FINAL="final",e.ERROR="error",e))(t||{});class ApiError extends Error{constructor(e,t){super(e),this.message=e,this.statusCode=t,this.name="ApiError"}}var n=(e=>(e[e.WRONG_CREDENTIALS=414]="WRONG_CREDENTIALS",e[e.EXPIRED_TOKENS=413]="EXPIRED_TOKENS",e))(n||{});var s=(e=>(e.CLOUD_VISION="cloud-vision",e.GEMINI="gemini",e))(s||{});const a={[s.CLOUD_VISION]:10,[s.GEMINI]:10};var i=(e=>(e.PHONE_ONLY="phone-only",e.FULL_DATA="full-data",e))(i||{});class ApiService{constructor(){__publicField(this,"API_BASE_URL","https://stg-bmp-api.billmyplate.com")}async fetchConfirmationData(e,t){try{if(!e||!t)throw new Error("Invalid merchantId or pumpNumber");const n=await fetch(`${this.API_BASE_URL}/event/plate-detection/latest?merchantId=${e}&pumpNumber=${t}`);if(!n.ok)throw new ApiError(`Request failed: ${n.statusText}`,n.status);return await n.json()}catch(n){throw n}}async registerCustomer(e,t,s,a){if(!e||!t)throw new Error("Missing phone or creditCard");try{const r={registrationType:s?i.FULL_DATA:i.PHONE_ONLY,phone:e,creditCard:t,...s?{...s,isWithPassword:Boolean(a)}:{}},o=await fetch(`${this.API_BASE_URL}/customer/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok){const e=await o.json().catch((()=>({})));if("CUSTOMER_WRONG_LOGIN_OR_PASSWORD"===(null==e?void 0:e.message))throw new ApiError(e.message,n.WRONG_CREDENTIALS);throw new ApiError(e.message||`Request failed: ${o.statusText}`,o.status)}return await o.json()}catch(r){throw r}}async verifySmsToken(e,t,n,s){try{if(!e||!t)throw new Error("Missing id or token");const{position:a,...i}=n||{},r=await fetch(`${this.API_BASE_URL}/customer/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,token:t,plate:s,...n?{pumpData:{...i,...a}}:{}})});if(!r.ok)throw new ApiError(`Request failed: ${r.statusText}`,r.status);return await r.json()}catch(a){throw a}}async loginCustomer(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/login-auth-pump`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();if("Expired Tokens"===(null==e?void 0:e.message))throw new ApiError(e.message,n.EXPIRED_TOKENS);throw new ApiError(e.message||`Request failed: ${t.statusText}`,t.status)}return await t.json()}catch(t){throw t}}async listStores(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/stores?longitude=${e.longitude}&latitude=${e.latitude}`,{method:"GET",headers:{"Content-Type":"application/json"}});return await t.json()}catch(t){throw t}}async resetPassword(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!t.ok)throw new ApiError(`Request failed: ${t.statusText}`,t.status);return}catch(t){throw t}}async getCardInfo(e,t=6e4){const n=function(e){const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(t.length),a=new Uint8Array(s);for(let i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return new Blob([s],{type:n})}(e),i=new FormData;i.append("image",n,"card.jpeg");const r=s.GEMINI;if(o=r,!Object.values(s).includes(o))throw new Error("Invalid card reader provider");var o;const d=1024*a[r]*1024;if(n.size>d)throw new Error(`Image size is too large, Maximum allowed size is ${a[r]}MB.`);const l=new AbortController,c=setTimeout((()=>l.abort()),t);try{const e=await fetch(`${this.API_BASE_URL}/customer/read-card-info?provider=${r}`,{method:"POST",body:i,signal:l.signal});if(!e.ok)throw new Error(`Error ${e.statusText}`);return await e.json()}catch(u){if("AbortError"===(null==u?void 0:u.name))throw new Error("Request timed out");throw u}finally{clearTimeout(c)}}}class NotificationService{constructor(e,t){__publicField(this,"notification"),__publicField(this,"element"),__publicField(this,"onRemove"),__publicField(this,"template",'<div class="notification-box notification-{type}" data-notification-id="{id}" style="display: flex; align-items: center; justify-content: space-between; padding: 16px; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); position: relative; font-family: inherit; font-size: 15px; margin: 0; min-width: 220px; max-width: 100%; word-break: break-word; transform: translateX(0); opacity: 1; transition: transform 0.3s ease-out, opacity 0.3s ease-out; {boxStyle}">\n    <span>{message}</span>\n    <button class="notification-close-btn" style="background: transparent; border: none; color: inherit; font-size: 20px; cursor: pointer; margin-left: 16px;">Ã—</button>\n    <div class="notification-bar" style="position: absolute; left: 0; bottom: 0; height: 4px; width: 100%; transition: width 0.1s linear; background: {barColor};"></div>\n</div>'),this.notification=e,this.onRemove=t}render(){return this.processTemplate(this.template,{id:this.notification.id,type:this.notification.type,message:this.notification.message,barColor:this.getBarColor(this.notification.type),boxStyle:this.getBoxStyle(this.notification.type)})}attachEvents(e){if(this.element=e.querySelector(`[data-notification-id="${this.notification.id}"]`),this.element){const e=this.element.querySelector(".notification-close-btn");e&&e.addEventListener("click",(()=>{this.remove()})),this.addEntranceAnimation()}}remove(){this.element&&(this.element.style.transition="transform 0.3s ease-in, opacity 0.3s ease-in",this.element.style.transform="translateX(100%)",this.element.style.opacity="0",setTimeout((()=>{var e,t;null==(e=this.element)||e.remove(),null==(t=this.onRemove)||t.call(this,this.notification.id)}),300))}addEntranceAnimation(){this.element&&(this.element.style.transform="translateX(100%)",this.element.style.opacity="0",this.element.style.transition="transform 0.3s ease-out, opacity 0.3s ease-out",requestAnimationFrame((()=>{this.element&&(this.element.style.transform="translateX(0)",this.element.style.opacity="1")})))}updateProgress(e){var t;const n=null==(t=this.element)?void 0:t.querySelector(".notification-bar");n&&(n.style.width=e+"%")}getNotification(){return this.notification}getBarColor(e){return"error"===e?"#e53935":"warning"===e?"#fbc02d":"#43a047"}getBoxStyle(e){return"error"===e?"background: #ffebee; color: #b71c1c; border: 1px solid #e53935;":"warning"===e?"background: #fffde7; color: #f57c00; border: 1px solid #fbc02d;":"background: #e8f5e9; color: #1b5e20; border: 1px solid #43a047;"}processTemplate(e,t){return e.replace(/\{([^{}]+)\}/g,((e,n)=>n.trim()in t?t[n.trim()]:""))}}const r=class _NotificationWrapperService{constructor(){__publicField(this,"notifications",[]),__publicField(this,"notificationInstances",[]),__publicField(this,"nextId",1),__publicField(this,"container"),__publicField(this,"intervalId",null),this.container=this.ensureContainer(),this.render(),this.startTimer()}static getInstance(){return _NotificationWrapperService.instance||(_NotificationWrapperService.instance=new _NotificationWrapperService),_NotificationWrapperService.instance}push(e,t,n=5e3){const s={id:this.nextId++,type:e,message:t,duration:n,createdAt:Date.now()};this.notifications.push(s);const a=new NotificationService(s,(e=>this.remove(e)));this.notificationInstances.push(a),this.container.insertAdjacentHTML("beforeend",a.render()),a.attachEvents(this.container)}remove(e){const t=this.notificationInstances.findIndex((t=>t.getNotification().id===e));if(-1!==t){this.notificationInstances[t].remove(),setTimeout((()=>{this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e)),this.notifications=this.notifications.filter((t=>t.id!==e))}),300)}else this.notifications=this.notifications.filter((t=>t.id!==e)),this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e))}ensureContainer(){let e=document.getElementById("notification-wrapper");return e||(e=document.createElement("div"),e.id="notification-wrapper",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.gap="12px",e.style.maxWidth="350px",document.body.appendChild(e)),e}render(){this.container.innerHTML="",this.notificationInstances.forEach((e=>{this.container.insertAdjacentHTML("beforeend",e.render()),e.attachEvents(this.container)}))}startTimer(){this.intervalId||(this.intervalId=window.setInterval((()=>{const e=Date.now(),t=[];this.notificationInstances.forEach((n=>{const s=n.getNotification(),a=e-s.createdAt,i=Math.max(0,100-a/s.duration*100);n.updateProgress(i),a>=s.duration&&t.push(s.id)})),t.forEach((e=>{const t=this.notificationInstances.findIndex((t=>t.getNotification().id===e));if(-1!==t){this.notificationInstances[t].remove(),setTimeout((()=>{this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e)),this.notifications=this.notifications.filter((t=>t.id!==e))}),300)}}))}),100))}};__publicField(r,"instance");let o=r;const d=class _LoadingOverlayService{constructor(){__publicField(this,"overlay",null),__publicField(this,"visible",!1),this.initializeOverlay()}static getInstance(){return _LoadingOverlayService.instance||(_LoadingOverlayService.instance=new _LoadingOverlayService),_LoadingOverlayService.instance}initializeOverlay(){this.overlay=document.getElementById("global-loading-overlay"),this.overlay}show(){this.overlay&&(this.overlay.style.opacity="1",this.overlay.style.visibility="visible",this.visible=!0)}hide(){this.overlay&&(this.overlay.style.opacity="0",this.overlay.style.visibility="hidden",this.visible=!1)}isVisible(){return this.visible}};__publicField(d,"instance");let l=d;class BaseComponent{constructor(e){__publicField(this,"store"),__publicField(this,"state"),__publicField(this,"apiService",new ApiService),__publicField(this,"notificationWrapper",o.getInstance()),__publicField(this,"templates",Object.assign({"./canceled/canceled.template.html":'<section class="container">\n  <div class="col-container">\n    <h1 class="heading" id="main-heading">{message}</h1>\n\n    <button\n      id="closeBtn"\n      class="btn btn-primary"\n      aria-label="Close the form"\n      aria-labelledby="main-heading"\n    >\n      <span>Close</span>\n    </button>\n  </div>\n</section>\n',"./card-reader/card-reader.template.html":'\x3c!-- Full Screen Card Scanner --\x3e\n<div class="card-scanner-fullscreen">\n  \x3c!-- Full screen overlay --\x3e\n  <div class="scanner-overlay">\n    \x3c!-- Header --\x3e\n    <div class="scanner-header">\n      <button id="close-scanner" class="close-button" aria-label="Close scanner">\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      </button>\n      <h1 class="scanner-title">Add a card</h1>\n    </div>\n    \n    \x3c!-- Main scanning area --\x3e\n    <div class="scanner-main">\n      \x3c!-- Instruction text --\x3e\n      <div class="scanner-instruction">\n        <p class="instruction-text">Line it up with the frame.</p>\n      </div>\n      \n      \x3c!-- Camera viewport with single card frame --\x3e\n      <div class="camera-viewport">\n        <video id="camera-feed" class="camera-video" autoplay playsinline></video>\n        \n        \n        \n        \x3c!-- Processing indicator (hidden by default) --\x3e\n        <div id="processing-indicator" class="processing-overlay hidden">\n          <div class="processing-content">\n            <div class="spinner"></div>\n            <p class="processing-text">Processing...</p>\n          </div>\n        </div>\n        \n        \x3c!-- Camera error message (hidden by default) --\x3e\n        <div id="camera-error" class="error-overlay hidden">\n          <div class="error-content">\n            <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\n            </svg>\n            <p class="error-title">Camera access denied or not available</p>\n            <p class="error-subtitle">Please allow camera access and try again</p>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    \x3c!-- Footer with manual entry option --\x3e\n    <div class="scanner-footer">\n      <p class="manual-entry-text">Or enter details manually</p>\n    </div>\n  </div>\n  \n  \x3c!-- Hidden elements for results --\x3e\n  <div class="hidden-results">\n    <div id="scan-error-message" class="scan-error hidden">\n      Unable to process image. Please try again with better lighting and alignment.\n    </div>\n  </div>\n</div>\n',"./initial/initial.template.html":'<div class="container">\n  <div class="relative w-12 h-12">\n    <div\n      class="absolute w-full h-full border-4 rounded-full border-transparent border-t-sunflower-yellow animate-spin"\n    >\n    \n  </div>\n    <div\n      class="absolute w-full h-full border-4 rounded-full border-transparent border-b-navy-blue animate-[spin_1.5s_linear_reverse_infinite]"\n    ></div>\n  </div>\n</div>\n'})),this.store=e,this.state=e.getState()}handleDomAccessError(e){this.store.transitionTo(this.state.state)}$(e){const t=document.querySelector(e);return t||this.handleDomAccessError(e),t}$_all(e){const t=document.querySelectorAll(e);return 0===t.length&&this.handleDomAccessError(e),t}buildTemplatePath(){const e=this.constructor.name.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().replace("-component","");return`./${e}/${e}.template.html`}processTemplate(e,t){return e.replace(/\{([^{}]+)\}/g,((e,n)=>n.trim()in t?t[n.trim()]:""))}templateData(){return{}}showError(e,t=5e3){this.notificationWrapper.push("error",e,t)}showWarning(e,t=5e3){this.notificationWrapper.push("warning",e,t)}showMessage(e,t=5e3){this.notificationWrapper.push("message",e,t)}displayLoading(){l.getInstance().show()}hideLoading(){l.getInstance().hide()}render(){try{const t=this.buildTemplatePath();if(t in this.templates)try{const e=this.templates[t];return this.processTemplate(e,this.templateData())}catch(e){this.showError(`Failed to load template: ${t}`),this.store.transitionTo(this.state.state)}else this.showError(`Template not found: ${t}`)}catch(e){this.showError("An error occurred while rendering the component")}return""}preventNonNumericValues(e,t){t.forEach((t=>{const n=e.querySelector(t);n.addEventListener("input",(()=>{n.value=n.value.replace(/\D/g,"")}))}))}attachEvents(){try{this.attachEventsInternal()}catch(e){this.showError("An error occurred while setting up component events")}}attachEventsInternal(){}}class InitialComponent extends BaseComponent{}var c,u,p;(u=c||(c={})).assertEqual=e=>{},u.assertIs=function(e){},u.assertNever=function(e){throw new Error},u.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},u.getValidEnumValues=e=>{const t=u.objectKeys(e).filter((t=>"number"!=typeof e[e[t]])),n={};for(const s of t)n[s]=e[s];return u.objectValues(n)},u.objectValues=e=>u.objectKeys(e).map((function(t){return e[t]})),u.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},u.find=(e,t)=>{for(const n of e)if(t(n))return n},u.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,u.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},u.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(p||(p={})).mergeShapes=(e,t)=>({...e,...t});const h=c.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=e=>{switch(typeof e){case"undefined":return h.undefined;case"string":return h.string;case"number":return Number.isNaN(e)?h.nan:h.number;case"boolean":return h.boolean;case"function":return h.function;case"bigint":return h.bigint;case"symbol":return h.symbol;case"object":return Array.isArray(e)?h.array:null===e?h.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?h.promise:"undefined"!=typeof Map&&e instanceof Map?h.map:"undefined"!=typeof Set&&e instanceof Set?h.set:"undefined"!=typeof Date&&e instanceof Date?h.date:h.object;default:return h.unknown}},m=c.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ZodError extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},processError=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(processError);else if("invalid_return_type"===s.code)processError(s.returnTypeError);else if("invalid_arguments"===s.code)processError(s.argumentsError);else if(0===s.path.length)n._errors.push(t(s));else{let e=n,a=0;for(;a<s.path.length;){const n=s.path[a];a===s.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(s))):e[n]=e[n]||{_errors:[]},e=e[n],a++}}};return processError(this),n}static assert(e){if(!(e instanceof ZodError))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,c.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ZodError.create=e=>new ZodError(e);const errorMap=(e,t)=>{let n;switch(e.code){case m.invalid_type:n=e.received===h.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case m.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,c.jsonStringifyReplacer)}`;break;case m.unrecognized_keys:n=`Unrecognized key(s) in object: ${c.joinValues(e.keys,", ")}`;break;case m.invalid_union:n="Invalid input";break;case m.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${c.joinValues(e.options)}`;break;case m.invalid_enum_value:n=`Invalid enum value. Expected ${c.joinValues(e.options)}, received '${e.received}'`;break;case m.invalid_arguments:n="Invalid function arguments";break;case m.invalid_return_type:n="Invalid function return type";break;case m.invalid_date:n="Invalid date";break;case m.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:c.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case m.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case m.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case m.custom:n="Invalid input";break;case m.invalid_intersection_types:n="Intersection results could not be merged";break;case m.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case m.not_finite:n="Number must be finite";break;default:n=t.defaultError,c.assertNever(e)}return{message:n}};let f=errorMap;function addIssueToContext(e,t){const n=f,s=(e=>{const{data:t,path:n,errorMaps:s,issueData:a}=e,i=[...n,...a.path||[]],r={...a,path:i};if(void 0!==a.message)return{...a,path:i,message:a.message};let o="";const d=s.filter((e=>!!e)).slice().reverse();for(const l of d)o=l(r,{data:t,defaultError:o}).message;return{...a,path:i,message:o}})({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===errorMap?void 0:errorMap].filter((e=>!!e))});e.common.issues.push(s)}class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if("aborted"===s.status)return v;"dirty"===s.status&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t){const e=await s.key,t=await s.value;n.push({key:e,value:t})}return ParseStatus.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:t,value:a}=s;if("aborted"===t.status)return v;if("aborted"===a.status)return v;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!s.alwaysSet||(n[t.value]=a.value)}return{status:e.value,value:n}}}const v=Object.freeze({status:"aborted"}),DIRTY=e=>({status:"dirty",value:e}),OK=e=>({status:"valid",value:e}),isAborted=e=>"aborted"===e.status,isDirty=e=>"dirty"===e.status,isValid=e=>"valid"===e.status,isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise;var g,y;(y=g||(g={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},y.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class ParseInputLazyPath{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(e,t)=>{if(isValid(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ZodError(e.common.issues);return this._error=t,this._error}}};function processCreateParams(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:s,description:a}=e;if(t&&(n||s))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{const{message:i}=e;return"invalid_enum_value"===t.code?{message:i??a.defaultError}:void 0===a.data?{message:i??s??a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:i??n??a.defaultError}},description:a}}class ZodType{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(isAsync(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(null==t?void 0:t.async)??!1,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},s=this._parseSync({data:e,path:n.path,parent:n});return handleResult(n,s)}"~validate"(e){var t,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:s});return isValid(t)?{value:t.value}:{issues:s.common.issues}}catch(a){(null==(n=null==(t=null==a?void 0:a.message)?void 0:t.toLowerCase())?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then((e=>isValid(e)?{value:e.value}:{issues:s.common.issues}))}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},s=this._parse({data:e,path:n.path,parent:n}),a=await(isAsync(s)?s:Promise.resolve(s));return handleResult(n,a)}refine(e,t){const getIssueProperties=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,n)=>{const s=e(t),setError=()=>n.addIssue({code:m.custom,...getIssueProperties(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(setError(),!1))):!!s||(setError(),!1)}))}refinement(e,t){return this._refinement(((n,s)=>!!e(n)||(s.addIssue("function"==typeof t?t(n,s):t),!1)))}_refinement(e){return new ZodEffects({schema:this,typeName:j.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:j.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:t,typeName:j.ZodDefault})}brand(){return new ZodBranded({typeName:j.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:t,typeName:j.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const b=/^c[^\s-]{8,}$/i,x=/^[0-9a-z]+$/,_=/^[0-9A-HJKMNP-TV-Z]{26}$/i,w=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,C=/^[a-z0-9_-]{21}$/i,I=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,E=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,k=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Z;const T=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,S=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,P=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,N=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,O=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,A=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,L="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",R=new RegExp(`^${L}$`);function timeRegexSource(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function datetimeRegex(e){let t=`${L}T${timeRegexSource(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function isValidJWT(e,t){if(!I.test(e))return!1;try{const[n]=e.split("."),s=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(s));return"object"==typeof a&&null!==a&&((!("typ"in a)||"JWT"===(null==a?void 0:a.typ))&&(!!a.alg&&(!t||a.alg===t)))}catch{return!1}}function isValidCidr(e,t){return!("v4"!==t&&t||!S.test(e))||!("v6"!==t&&t||!N.test(e))}class ZodString extends ZodType{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==h.string){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.string,received:t.parsedType}),v}const t=new ParseStatus;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const s=e.data.length>i.value,a=e.data.length<i.value;(s||a)&&(n=this._getOrReturnCtx(e,n),s?addIssueToContext(n,{code:m.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&addIssueToContext(n,{code:m.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)k.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"email",code:m.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)Z||(Z=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Z.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"emoji",code:m.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)w.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"uuid",code:m.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)C.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"nanoid",code:m.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)b.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"cuid",code:m.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)x.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"cuid2",code:m.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)_.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"ulid",code:m.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"url",code:m.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"regex",code:m.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){datetimeRegex(i).test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){R.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${timeRegexSource(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?E.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"duration",code:m.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?(s=e.data,("v4"!==(a=i.version)&&a||!T.test(s))&&("v6"!==a&&a||!P.test(s))&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"ip",code:m.invalid_string,message:i.message}),t.dirty())):"jwt"===i.kind?isValidJWT(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"jwt",code:m.invalid_string,message:i.message}),t.dirty()):"cidr"===i.kind?isValidCidr(e.data,i.version)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"cidr",code:m.invalid_string,message:i.message}),t.dirty()):"base64"===i.kind?O.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"base64",code:m.invalid_string,message:i.message}),t.dirty()):"base64url"===i.kind?A.test(e.data)||(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{validation:"base64url",code:m.invalid_string,message:i.message}),t.dirty()):c.assertNever(i);var s,a;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:m.invalid_string,...g.errToObj(n)})}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...g.errToObj(e)})}url(e){return this._addCheck({kind:"url",...g.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...g.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...g.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...g.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...g.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...g.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...g.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...g.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...g.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...g.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...g.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...g.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:(null==e?void 0:e.offset)??!1,local:(null==e?void 0:e.local)??!1,...g.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...g.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...g.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...g.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...g.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...g.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...g.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...g.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...g.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...g.errToObj(t)})}nonempty(e){return this.min(1,g.errToObj(e))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function floatSafeRemainder(e,t){const n=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,a=n>s?n:s;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}ZodString.create=e=>new ZodString({checks:[],typeName:j.ZodString,coerce:(null==e?void 0:e.coerce)??!1,...processCreateParams(e)});class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==h.number){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.number,received:t.parsedType}),v}let t;const n=new ParseStatus;for(const s of this._def.checks)if("int"===s.kind)c.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.invalid_type,expected:"integer",received:"float",message:s.message}),n.dirty());else if("min"===s.kind){(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty())}else if("max"===s.kind){(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty())}else"multipleOf"===s.kind?0!==floatSafeRemainder(e.data,s.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_finite,message:s.message}),n.dirty()):c.assertNever(s);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,n,s){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:g.toString(s)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:g.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:g.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:g.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:g.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&c.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ZodNumber.create=e=>new ZodNumber({checks:[],typeName:j.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==h.bigint)return this._getInvalidInput(e);let t;const n=new ParseStatus;for(const s of this._def.checks)if("min"===s.kind){(s.inclusive?e.data<s.value:e.data<=s.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty())}else if("max"===s.kind){(s.inclusive?e.data>s.value:e.data>=s.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty())}else"multipleOf"===s.kind?e.data%s.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):c.assertNever(s);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.bigint,received:t.parsedType}),v}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,n,s){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:g.toString(s)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ZodBigInt.create=e=>new ZodBigInt({checks:[],typeName:j.ZodBigInt,coerce:(null==e?void 0:e.coerce)??!1,...processCreateParams(e)});class ZodBoolean extends ZodType{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==h.boolean){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.boolean,received:t.parsedType}),v}return OK(e.data)}}ZodBoolean.create=e=>new ZodBoolean({typeName:j.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodDate extends ZodType{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==h.date){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.date,received:t.parsedType}),v}if(Number.isNaN(e.data.getTime())){return addIssueToContext(this._getOrReturnCtx(e),{code:m.invalid_date}),v}const t=new ParseStatus;let n;for(const s of this._def.checks)"min"===s.kind?e.data.getTime()<s.value&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),t.dirty()):"max"===s.kind?e.data.getTime()>s.value&&(n=this._getOrReturnCtx(e,n),addIssueToContext(n,{code:m.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),t.dirty()):c.assertNever(s);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:g.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:g.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}ZodDate.create=e=>new ZodDate({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:j.ZodDate,...processCreateParams(e)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==h.symbol){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.symbol,received:t.parsedType}),v}return OK(e.data)}}ZodSymbol.create=e=>new ZodSymbol({typeName:j.ZodSymbol,...processCreateParams(e)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.undefined,received:t.parsedType}),v}return OK(e.data)}}ZodUndefined.create=e=>new ZodUndefined({typeName:j.ZodUndefined,...processCreateParams(e)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==h.null){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.null,received:t.parsedType}),v}return OK(e.data)}}ZodNull.create=e=>new ZodNull({typeName:j.ZodNull,...processCreateParams(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}}ZodAny.create=e=>new ZodAny({typeName:j.ZodAny,...processCreateParams(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}}ZodUnknown.create=e=>new ZodUnknown({typeName:j.ZodUnknown,...processCreateParams(e)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.never,received:t.parsedType}),v}}ZodNever.create=e=>new ZodNever({typeName:j.ZodNever,...processCreateParams(e)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.void,received:t.parsedType}),v}return OK(e.data)}}ZodVoid.create=e=>new ZodVoid({typeName:j.ZodVoid,...processCreateParams(e)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==h.array)return addIssueToContext(t,{code:m.invalid_type,expected:h.array,received:t.parsedType}),v;if(null!==s.exactLength){const e=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(e||a)&&(addIssueToContext(t,{code:e?m.too_big:m.too_small,minimum:a?s.exactLength.value:void 0,maximum:e?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(null!==s.minLength&&t.data.length<s.minLength.value&&(addIssueToContext(t,{code:m.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),null!==s.maxLength&&t.data.length>s.maxLength.value&&(addIssueToContext(t,{code:m.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>s.type._parseAsync(new ParseInputLazyPath(t,e,t.path,n))))).then((e=>ParseStatus.mergeArray(n,e)));const a=[...t.data].map(((e,n)=>s.type._parseSync(new ParseInputLazyPath(t,e,t.path,n))));return ParseStatus.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:g.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:g.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:g.toString(t)}})}nonempty(e){return this.min(1,e)}}function deepPartialify(e){if(e instanceof ZodObject){const t={};for(const n in e.shape){const s=e.shape[n];t[n]=ZodOptional.create(deepPartialify(s))}return new ZodObject({...e._def,shape:()=>t})}return e instanceof ZodArray?new ZodArray({...e._def,type:deepPartialify(e.element)}):e instanceof ZodOptional?ZodOptional.create(deepPartialify(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(deepPartialify(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map((e=>deepPartialify(e)))):e}ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:j.ZodArray,...processCreateParams(t)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=c.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==h.object){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.object,received:t.parsedType}),v}const{status:t,ctx:n}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const o in n.data)a.includes(o)||i.push(o);const r=[];for(const o of a){const e=s[o],t=n.data[o];r.push({key:{status:"valid",value:o},value:e._parse(new ParseInputLazyPath(n,t,n.path,o)),alwaysSet:o in n.data})}if(this._def.catchall instanceof ZodNever){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of i)r.push({key:{status:"valid",value:t},value:{status:"valid",value:n.data[t]}});else if("strict"===e)i.length>0&&(addIssueToContext(n,{code:m.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const s=n.data[t];r.push({key:{status:"valid",value:t},value:e._parse(new ParseInputLazyPath(n,s,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of r){const n=await t.key,s=await t.value;e.push({key:n,value:s,alwaysSet:t.alwaysSet})}return e})).then((e=>ParseStatus.mergeObjectSync(t,e))):ParseStatus.mergeObjectSync(t,r)}get shape(){return this._def.shape()}strict(e){return g.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var s,a;const i=(null==(a=(s=this._def).errorMap)?void 0:a.call(s,t,n).message)??n.defaultError;return"unrecognized_keys"===t.code?{message:g.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:j.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};for(const n of c.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};for(const n of c.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new ZodObject({...this._def,shape:()=>t})}deepPartial(){return deepPartialify(this)}partial(e){const t={};for(const n of c.objectKeys(this.shape)){const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}return new ZodObject({...this._def,shape:()=>t})}required(e){const t={};for(const n of c.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof ZodOptional;)e=e._def.innerType;t[n]=e}return new ZodObject({...this._def,shape:()=>t})}keyof(){return createZodEnum(c.objectKeys(this.shape))}}ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const s of e)if("dirty"===s.result.status)return t.common.issues.push(...s.ctx.common.issues),s.result;const n=e.map((e=>new ZodError(e.ctx.common.issues)));return addIssueToContext(t,{code:m.invalid_union,unionErrors:n}),v}));{let e;const s=[];for(const i of n){const n={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:n}),n.common.issues.length&&s.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=s.map((e=>new ZodError(e)));return addIssueToContext(t,{code:m.invalid_union,unionErrors:a}),v}}get options(){return this._def.options}}function mergeValues(e,t){const n=getParsedType(e),s=getParsedType(t);if(e===t)return{valid:!0,data:e};if(n===h.object&&s===h.object){const n=c.objectKeys(t),s=c.objectKeys(e).filter((e=>-1!==n.indexOf(e))),a={...e,...t};for(const i of s){const n=mergeValues(e[i],t[i]);if(!n.valid)return{valid:!1};a[i]=n.data}return{valid:!0,data:a}}if(n===h.array&&s===h.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let s=0;s<e.length;s++){const a=mergeValues(e[s],t[s]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}return n===h.date&&s===h.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:j.ZodUnion,...processCreateParams(t)});class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),handleParsed=(e,s)=>{if(isAborted(e)||isAborted(s))return v;const a=mergeValues(e.value,s.value);return a.valid?((isDirty(e)||isDirty(s))&&t.dirty(),{status:t.value,value:a.data}):(addIssueToContext(n,{code:m.invalid_intersection_types}),v)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>handleParsed(e,t))):handleParsed(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ZodIntersection.create=(e,t,n)=>new ZodIntersection({left:e,right:t,typeName:j.ZodIntersection,...processCreateParams(n)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.array)return addIssueToContext(n,{code:m.invalid_type,expected:h.array,received:n.parsedType}),v;if(n.data.length<this._def.items.length)return addIssueToContext(n,{code:m.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),v;!this._def.rest&&n.data.length>this._def.items.length&&(addIssueToContext(n,{code:m.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...n.data].map(((e,t)=>{const s=this._def.items[t]||this._def.rest;return s?s._parse(new ParseInputLazyPath(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(s).then((e=>ParseStatus.mergeArray(t,e))):ParseStatus.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:j.ZodTuple,rest:null,...processCreateParams(t)})};class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.map)return addIssueToContext(n,{code:m.invalid_type,expected:h.map,received:n.parsedType}),v;const s=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map((([e,t],i)=>({key:s._parse(new ParseInputLazyPath(n,e,n.path,[i,"key"])),value:a._parse(new ParseInputLazyPath(n,t,n.path,[i,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of i){const s=await n.key,a=await n.value;if("aborted"===s.status||"aborted"===a.status)return v;"dirty"!==s.status&&"dirty"!==a.status||t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of i){const s=n.key,a=n.value;if("aborted"===s.status||"aborted"===a.status)return v;"dirty"!==s.status&&"dirty"!==a.status||t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}}}}ZodMap.create=(e,t,n)=>new ZodMap({valueType:t,keyType:e,typeName:j.ZodMap,...processCreateParams(n)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==h.set)return addIssueToContext(n,{code:m.invalid_type,expected:h.set,received:n.parsedType}),v;const s=this._def;null!==s.minSize&&n.data.size<s.minSize.value&&(addIssueToContext(n,{code:m.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),null!==s.maxSize&&n.data.size>s.maxSize.value&&(addIssueToContext(n,{code:m.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function finalizeSet(e){const n=new Set;for(const s of e){if("aborted"===s.status)return v;"dirty"===s.status&&t.dirty(),n.add(s.value)}return{status:t.value,value:n}}const i=[...n.data.values()].map(((e,t)=>a._parse(new ParseInputLazyPath(n,e,n.path,t))));return n.common.async?Promise.all(i).then((e=>finalizeSet(e))):finalizeSet(i)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:g.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:g.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:j.ZodSet,...processCreateParams(t)});class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:j.ZodLazy,...processCreateParams(t)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{received:t.data,code:m.invalid_literal,expected:this._def.value}),v}return{status:"valid",value:e.data}}get value(){return this._def.value}}function createZodEnum(e,t){return new ZodEnum({values:e,typeName:j.ZodEnum,...processCreateParams(t)})}ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:j.ZodLiteral,...processCreateParams(t)});class ZodEnum extends ZodType{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(t,{expected:c.joinValues(n),received:t.parsedType,code:m.invalid_type}),v}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return addIssueToContext(t,{received:t.data,code:m.invalid_enum_value,options:n}),v}return OK(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ZodEnum.create(e,{...this._def,...t})}exclude(e,t=this._def){return ZodEnum.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{_parse(e){const t=c.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==h.string&&n.parsedType!==h.number){const e=c.objectValues(t);return addIssueToContext(n,{expected:c.joinValues(e),received:n.parsedType,code:m.invalid_type}),v}if(this._cache||(this._cache=new Set(c.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=c.objectValues(t);return addIssueToContext(n,{received:n.data,code:m.invalid_enum_value,options:e}),v}return OK(e.data)}get enum(){return this._def.values}}ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:j.ZodNativeEnum,...processCreateParams(t)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.promise&&!1===t.common.async)return addIssueToContext(t,{code:m.invalid_type,expected:h.promise,received:t.parsedType}),v;const n=t.parsedType===h.promise?t.data:Promise.resolve(t.data);return OK(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:j.ZodPromise,...processCreateParams(t)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===j.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:e=>{addIssueToContext(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===s.type){const e=s.transform(n.data,a);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return v;const s=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===s.status?v:"dirty"===s.status||"dirty"===t.value?DIRTY(s.value):s}));{if("aborted"===t.value)return v;const s=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===s.status?v:"dirty"===s.status||"dirty"===t.value?DIRTY(s.value):s}}if("refinement"===s.type){const executeRefinement=e=>{const t=s.refinement(e,a);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?v:("dirty"===e.status&&t.dirty(),executeRefinement(e.value),{status:t.value,value:e.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>"aborted"===e.status?v:("dirty"===e.status&&t.dirty(),executeRefinement(e.value).then((()=>({status:t.value,value:e.value}))))))}if("transform"===s.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!isValid(e))return v;const i=s.transform(e.value,a);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>isValid(e)?Promise.resolve(s.transform(e.value,a)).then((e=>({status:t.value,value:e}))):v))}c.assertNever(s)}}ZodEffects.create=(e,t,n)=>new ZodEffects({schema:e,typeName:j.ZodEffects,effect:t,...processCreateParams(n)}),ZodEffects.createWithPreprocess=(e,t,n)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:j.ZodEffects,...processCreateParams(n)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===h.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:j.ZodOptional,...processCreateParams(t)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===h.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:j.ZodNullable,...processCreateParams(t)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===h.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:j.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...processCreateParams(t)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return isAsync(s)?s.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new ZodError(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:j.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...processCreateParams(t)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==h.nan){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.nan,received:t.parsedType}),v}return{status:"valid",value:e.data}}}ZodNaN.create=e=>new ZodNaN({typeName:j.ZodNaN,...processCreateParams(e)});class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?v:"dirty"===e.status?(t.dirty(),DIRTY(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?v:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:j.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(e){const t=this._def.innerType._parse(e),freeze=e=>(isValid(e)&&(e.value=Object.freeze(e.value)),e);return isAsync(t)?t.then((e=>freeze(e))):freeze(t)}unwrap(){return this._def.innerType}}var j,$;ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:j.ZodReadonly,...processCreateParams(t)}),($=j||(j={})).ZodString="ZodString",$.ZodNumber="ZodNumber",$.ZodNaN="ZodNaN",$.ZodBigInt="ZodBigInt",$.ZodBoolean="ZodBoolean",$.ZodDate="ZodDate",$.ZodSymbol="ZodSymbol",$.ZodUndefined="ZodUndefined",$.ZodNull="ZodNull",$.ZodAny="ZodAny",$.ZodUnknown="ZodUnknown",$.ZodNever="ZodNever",$.ZodVoid="ZodVoid",$.ZodArray="ZodArray",$.ZodObject="ZodObject",$.ZodUnion="ZodUnion",$.ZodDiscriminatedUnion="ZodDiscriminatedUnion",$.ZodIntersection="ZodIntersection",$.ZodTuple="ZodTuple",$.ZodRecord="ZodRecord",$.ZodMap="ZodMap",$.ZodSet="ZodSet",$.ZodFunction="ZodFunction",$.ZodLazy="ZodLazy",$.ZodLiteral="ZodLiteral",$.ZodEnum="ZodEnum",$.ZodEffects="ZodEffects",$.ZodNativeEnum="ZodNativeEnum",$.ZodOptional="ZodOptional",$.ZodNullable="ZodNullable",$.ZodDefault="ZodDefault",$.ZodCatch="ZodCatch",$.ZodPromise="ZodPromise",$.ZodBranded="ZodBranded",$.ZodPipeline="ZodPipeline",$.ZodReadonly="ZodReadonly";const M=ZodString.create,D=ZodNumber.create;ZodNever.create,ZodArray.create;const F=ZodObject.create;ZodUnion.create,ZodIntersection.create,ZodTuple.create,ZodEnum.create,ZodPromise.create,ZodOptional.create,ZodNullable.create;const z=/^(0[1-9]|1[0-2])\/([0-9]{2})$/,B=F({creditCard:F({cardNumber:M().min(13,{message:"Card number must be at least 13 digits"}).max(19,{message:"Card number must be at most 19 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Card number must contain only digits"}),exp:M().min(1,{message:"Expiration date is required"}).regex(z,{message:"Expiration date must be in the format MM/YY (e.g., 12/23)"}).refine((e=>{if(!z.test(e))return!0;const[t,n]=e.split("/"),s=parseInt(t,10),a=parseInt("20"+n,10),i=new Date,r=i.getFullYear(),o=i.getMonth()+1;return!(a<r)&&!(a===r&&s<o)}),{message:"Card has expired. Please enter a valid expiration date."}),zipCode:M().length(5,{message:"ZIP code must be a 5-digit number"}).refine((e=>/^\d+$/.test(e)),{message:"ZIP code must contain only digits"}),cvv:M().min(3,{message:"CVV must be at least 3 digits"}).max(4,{message:"CVV must be at most 4 digits"}).refine((e=>/^\d+$/.test(e)),{message:"CVV must contain only digits"})}),phone:M().length(10,{message:"Phone number must be a numeric value with 10 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Phone number must contain only digits"})});function validate(e,t){const n=e.safeParse(t),s={};if(!n.success)for(const a of n.error.issues){const e=a.path.join(".");s[e]||(s[e]=[]),s[e].push(a.message)}return s}class PageBaseComponent extends BaseComponent{constructor(e){super(e),this.templates=Object.assign({"./extended-register-form/extended-register-form.template.html":'<section class="container">\n    <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\n      <div class="mx-auto max-w-5xl">\n        <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\n          <form class="form bordered-form" aria-labelledby="credit-card-form">\n            <h2 id="credit-card-form" class="sr-only">Register to authorize pump</h2>\n\n            \x3c!-- New Fields --\x3e\n            <div class="mb-6 grid grid-cols-2 gap-4">\n              \x3c!-- First Name --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label for="first-name" class="mb-2 block text-sm font-medium">First Name*</label>\n                <input\n                  type="text"\n                  id="first-name"\n                  class="form-input"\n                  placeholder="John"\n                  aria-required="true"\n                />\n              </div>\n\n              \x3c!-- Last Name --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label for="last-name" class="mb-2 block text-sm font-medium">Last Name*</label>\n                <input\n                  type="text"\n                  id="last-name"\n                  class="form-input"\n                  placeholder="Doe"\n                  aria-required="true"\n                />\n              </div>\n\n              \x3c!-- Email --\x3e\n              <div class="col-span-2">\n                <label for="email" class="mb-2 block text-sm font-medium">Email*</label>\n                <input\n                  type="email"\n                  id="email"\n                  class="form-input"\n                  placeholder="example@example.com"\n                  aria-required="true"\n                />\n              </div>\n\n              \x3c!-- Password --\x3e\n              <div class="col-span-2">\n                \n                <label for="password" class="mb-2 block text-sm font-medium" id="password-label">Password*</label>\n                <p class="mb-4 text-sm text-gray-600" id="password-description">\n                  \n                </p>\n                <div class="relative">\n                  <input\n                    type="password"\n                    id="password"\n                    class="form-input"\n                    placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"\n                    aria-required="true"\n                  />\n                  <button\n                    type="button"\n                    id="reset-password-button"\n                    class="absolute right-2 top-1/2 -translate-y-1/2 text-sm text-navy-blue hover:text-navy-blue-dark cursor-pointer"\n                    aria-label="Reset password"\n                  >\n                    Reset Password\n                  </button>\n                </div>\n              </div>\n\n              \x3c!-- Pin Code --\x3e\n              <div class="col-span-2">\n                <label for="pin-code" class="mb-2 block text-sm font-medium">Pin Code*</label>\n                <input\n                  type="password"\n                  id="pin-code"\n                  class="form-input"\n                  maxlength="4"\n                  placeholder="1234"\n                  aria-required="true"\n                />\n              </div>\n            </div>\n\n\n            <div class="mb-6 grid grid-cols-1 gap-4">\n              \x3c!-- Mobile Phone Input --\x3e\n              <div class="col-span-1">\n                <label\n                  for="mobile-phone-input"\n                  class="mb-2 block text-sm font-medium"\n                  >Mobile Phone*</label\n                >\n                <input\n                  type="tel"\n                  id="mobile-phone-input"\n                  class="form-input"\n                  inputmode="tel"\n                  placeholder="(123) 456-7890"\n                  aria-required="true"\n                  aria-describedby="mobile-phone-description"\n                />\n                <span id="mobile-phone-description" class="sr-only">\n                  Enter your 10-digit mobile phone number.\n                </span>\n              </div>\n            </div>\n\n            \n          <div class="mb-6 grid grid-cols-1 gap-4">\n            \x3c!-- Pump Number Dropdown --\x3e\n            <div class="col-span-1">\n              <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\n                Pump Number*\n              </label>\n              <select\n                id="pump-number"\n                class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\n                aria-required="true"\n                aria-describedby="pump-number-description"\n              >\n                \x3c!-- Options will be dynamically populated --\x3e\n              </select>\n              <span id="pump-number-description" class="sr-only">\n                Select the pump number you want to authorize.\n              </span>\n            </div>\n          </div>\n\n            <div class="mb-6 grid grid-cols-2 gap-4">\n              \x3c!-- Card Number Input --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label\n                  for="card-number-input"\n                  class="mb-2 block text-sm font-medium"\n                  >Card number*</label\n                >\n                <div class="relative flex items-center">\n                  <input\n                    type="text"\n                    class="form-input w-full"\n                    aria-required="true"\n                    inputmode="numeric"\n                    id="card-number-input"\n                    placeholder="xxxx-xxxx-xxxx-xxxx"\n                    aria-describedby="card-number-description"\n                  />\n                  <button\n                    type="button"\n                    id="scan-card-btn"\n                    class="absolute right-2 p-1 text-gray-500 hover:text-navy-blue"\n                    aria-label="Scan credit card with camera"\n                  >\n                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\n                      <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4z" clip-rule="evenodd" />\n                      <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />\n                    </svg>\n                  </button>\n                </div>\n                <span id="card-number-description" class="sr-only">\n                  Enter your 16-digit card number without spaces or dashes.\n                </span>\n              </div>\n              \x3c!-- Zipcode Input --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label for="zipcode" class="mb-2 block text-sm font-medium"\n                  >Zipcode*</label\n                >\n                <input\n                  type="text"\n                  id="zipcode"\n                  maxlength="5"\n                  class="form-input"\n                  inputmode="numeric"\n                  placeholder="12345"\n                  aria-required="true"\n                  aria-describedby="zipcode-description"\n                />\n                <span id="zipcode-description" class="sr-only">\n                  Enter a 5-digit ZIP code.\n                </span>\n              </div>\n\n              \x3c!-- Card Expiration Input --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label\n                  for="card-expiration-input"\n                  class="mb-2 block text-sm font-medium"\n                  >Card expiration*</label\n                >\n                <div class="relative">\n                  <input\n                    type="text"\n                    class="form-input"\n                    placeholder="MM/YY"\n                    inputmode="numeric"\n                    aria-required="true"\n                    id="card-expiration-input"\n                    aria-describedby="card-expiration-description"\n                  />\n                  <span id="card-expiration-description" class="sr-only">\n                    Enter the expiration date in MM/YY format.\n                  </span>\n                </div>\n              </div>\n\n              \x3c!-- CVV Input with Tooltip --\x3e\n              <div class="col-span-2 sm:col-span-1">\n                <label for="cvv-input" class="mb-2 block text-sm font-medium">\n                  CVV*\n                  <button\n                    type="button"\n                    class="relative group"\n                    aria-label="CVV information"\n                  >\n                    <svg\n                      aria-hidden="true"\n                      fill="currentColor"\n                      viewBox="0 0 24 24"\n                      xmlns="http://www.w3.org/2000/svg"\n                      class="h-4 w-4 text-gray-400 hover:text-navy-blue"\n                    >\n                      <path\n                        fill-rule="evenodd"\n                        clip-rule="evenodd"\n                        d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.408-5.5a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2h-.01ZM10 10a1 1 0 1 0 0 2h1v3h-1a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2h-1v-4a1 1 0 0 0-1-1h-2Z"\n                      />\n                    </svg>\n                    <span\n                      role="tooltip"\n                      aria-hidden="true"\n                      class="absolute left-1/2 top-full mt-1 hidden w-max -translate-x-1/2 rounded-lg bg-navy-blue px-3 py-2 text-sm font-medium text-white shadow-md group-hover:block"\n                    >\n                      The last 3-4 digits on the back of the card\n                    </span>\n                  </button>\n                </label>\n                <input\n                  type="text"\n                  id="cvv-input"\n                  maxlength="4"\n                  placeholder="â€¢â€¢â€¢"\n                  class="form-input"\n                  inputmode="numeric"\n                  aria-required="true"\n                  aria-describedby="cvv-description"\n                />\n                <span id="cvv-description" class="sr-only">\n                  Enter the 3-digit security code found on the back of your card.\n                </span>\n              </div>\n            </div>\n\n            \x3c!-- Submit Button --\x3e\n            <button\n              type="submit"\n              aria-label="Register"\n              class="btn btn-primary w-full"\n            >\n              Submit\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n\n    <span id="error" class="error" role="alert"></span>\n  </section>\n\n  <div id="cardReaderModalContainer"></div>',"./final/final.template.html":'<div class="container">\n  <div class="col-container">\n    <img\n      role="img"\n      class="w-full h-64 md:h-80 object-cover rounded-lg"\n      src="pump.svg"\n      alt="Illustration of a gas pump"\n      aria-describedby="pump-instructions"\n    />\n\n    <h1 id="pump-instructions" class="heading">\n      Pump authorized successfully \n    </h1>\n  </div>\n</div>\n',"./login-form/login-form.template.html":'<section class="container">\n    <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\n      <div class="mx-auto max-w-5xl">\n        <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\n          <form class="form bordered-form" aria-labelledby="credit-card-form">\n            <h2 id="credit-card-form" class="sr-only">Login and authorize pump</h2>\n  \n            <div class="mb-6 grid grid-cols-1 gap-4">\n              \x3c!-- Mobile Phone Input --\x3e\n              <div class="col-span-1">\n                <label\n                  for="mobile-phone-input"\n                  class="mb-2 block text-sm font-medium"\n                  >Mobile Phone*</label\n                >\n                <input\n                  type="tel"\n                  id="mobile-phone-input"\n                  class="form-input"\n                  inputmode="tel"\n                  placeholder="(123) 456-7890"\n                  aria-required="true"\n                  aria-describedby="mobile-phone-description"\n                />\n                <span id="mobile-phone-description" class="sr-only">\n                  Enter your 10-digit mobile phone number.\n                </span>\n              </div>\n            </div>\n  \n            <div class="mb-6 grid grid-cols-1 gap-4">\n              \x3c!-- Pump Number Dropdown --\x3e\n              <div class="col-span-1">\n                <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\n                  Pump Number*\n                </label>\n                <select\n                  id="pump-number"\n                  class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\n                  aria-required="true"\n                  aria-describedby="pump-number-description"\n                >\n                  \x3c!-- Options will be dynamically populated --\x3e\n                </select>\n                <span id="pump-number-description" class="sr-only">\n                  Select the pump number you want to authorize.\n                </span>\n              </div>\n            </div>\n  \n            \x3c!-- Submit Button --\x3e\n            <button\n              type="submit"\n              aria-label="Register"\n              class="btn btn-primary w-full"\n            >\n              Submit\n            </button>\n          </form>\n        </div>\n      </div>\n    </div>\n  \n    <span id="error" class="error" role="alert"></span>\n  </section>',"./otp-form/otp-form.template.html":'<div class="container">\n  <div\n    class="form col-container border border-gray-200 shadow-sm justify-between"\n  >\n    <div class="col-container">\n      <div class="font-semibold text-3xl">\n        <p>Phone Verification</p>\n      </div>\n      <div class="flex flex-row text-sm font-medium text-gray-400">\n        <p>We have sent a code to your phone number</p>\n      </div>\n    </div>\n\n    <form class="form">\n      <div\n        class="flex flex-row items-center justify-between mx-auto w-full gap-1 my-5"\n      >\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n        <div class="w-16 h-16">\n          <input\n            name="otp"\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\n            type="number"\n            min="0"\n            max="9"\n          />\n        </div>\n      </div>\n\n      <button class="btn btn-primary w-full">Verify</button>\n    </form>\n    <span id="error" class="error mx-auto" role="alert"></span>\n  </div>\n</div>\n',"./register-form/register-form.template.html":'<section class="container">\n  <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\n    <div class="mx-auto max-w-5xl">\n      <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\n        <form class="form bordered-form" aria-labelledby="credit-card-form">\n          <h2 id="credit-card-form" class="sr-only">Register to authorize pump</h2>\n\n          <div class="mb-6 grid grid-cols-1 gap-4">\n            \x3c!-- Mobile Phone Input --\x3e\n            <div class="col-span-1">\n              <label\n                for="mobile-phone-input"\n                class="mb-2 block text-sm font-medium"\n                >Mobile Phone*</label\n              >\n              <input\n                type="tel"\n                id="mobile-phone-input"\n                class="form-input"\n                inputmode="tel"\n                placeholder="(123) 456-7890"\n                aria-required="true"\n                aria-describedby="mobile-phone-description"\n              />\n              <span id="mobile-phone-description" class="sr-only">\n                Enter your 10-digit mobile phone number.\n              </span>\n            </div>\n          </div>\n\n          <div class="mb-6 grid grid-cols-1 gap-4">\n            \x3c!-- Pump Number Dropdown --\x3e\n            <div class="col-span-1">\n              <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\n                Pump Number*\n              </label>\n              <select\n                id="pump-number"\n                class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\n                aria-required="true"\n                aria-describedby="pump-number-description"\n              >\n                \x3c!-- Options will be dynamically populated --\x3e\n              </select>\n              <span id="pump-number-description" class="sr-only">\n                Select the pump number you want to authorize.\n              </span>\n            </div>\n          </div>\n\n          <div class="mb-6 grid grid-cols-2 gap-4">\n            \x3c!-- Card Number Input --\x3e\n            <div class="col-span-2 sm:col-span-1">\n              <label\n                for="card-number-input"\n                class="mb-2 block text-sm font-medium"\n                >Card number*</label\n              >\n              <div class="relative flex items-center">\n                <input\n                  type="text"\n                  class="form-input w-full"\n                  aria-required="true"\n                  inputmode="numeric"\n                  id="card-number-input"\n                  placeholder="xxxx-xxxx-xxxx-xxxx"\n                  aria-describedby="card-number-description"\n                />\n                <button\n                  type="button"\n                  id="scan-card-btn"\n                  class="absolute right-2 p-1 text-gray-500 hover:text-navy-blue"\n                  aria-label="Scan credit card with camera"\n                >\n                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\n                    <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4z" clip-rule="evenodd" />\n                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />\n                  </svg>\n                </button>\n              </div>\n              <span id="card-number-description" class="sr-only">\n                Enter your 16-digit card number without spaces or dashes.\n              </span>\n            </div>\n\n            \x3c!-- Zipcode Input --\x3e\n            <div class="col-span-2 sm:col-span-1">\n              <label for="zipcode" class="mb-2 block text-sm font-medium"\n                >Zipcode*</label\n              >\n              <input\n                type="text"\n                id="zipcode"\n                maxlength="5"\n                class="form-input"\n                inputmode="numeric"\n                placeholder="12345"\n                aria-required="true"\n                aria-describedby="zipcode-description"\n              />\n              <span id="zipcode-description" class="sr-only">\n                Enter a 5-digit ZIP code.\n              </span>\n            </div>\n\n            \x3c!-- Card Expiration Input --\x3e\n            <div class="col-span-2 sm:col-span-1">\n              <label\n                for="card-expiration-input"\n                class="mb-2 block text-sm font-medium"\n                >Card expiration*</label\n              >\n              <div class="relative">\n                <input\n                  type="text"\n                  class="form-input"\n                  placeholder="MM/YY"\n                  inputmode="numeric"\n                  aria-required="true"\n                  id="card-expiration-input"\n                  aria-describedby="card-expiration-description"\n                />\n                <span id="card-expiration-description" class="sr-only">\n                  Enter the expiration date in MM/YY format.\n                </span>\n              </div>\n            </div>\n\n            \x3c!-- CVV Input with Tooltip --\x3e\n            <div class="col-span-2 sm:col-span-1">\n              <label for="cvv-input" class="mb-2 block text-sm font-medium">\n                CVV*\n                <button\n                  type="button"\n                  class="relative group"\n                  aria-label="CVV information"\n                >\n                  <svg\n                    aria-hidden="true"\n                    fill="currentColor"\n                    viewBox="0 0 24 24"\n                    xmlns="http://www.w3.org/2000/svg"\n                    class="h-4 w-4 text-gray-400 hover:text-navy-blue"\n                  >\n                    <path\n                      fill-rule="evenodd"\n                      clip-rule="evenodd"\n                      d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.408-5.5a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2h-.01ZM10 10a1 1 0 1 0 0 2h1v3h-1a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2h-1v-4a1 1 0 0 0-1-1h-2Z"\n                    />\n                  </svg>\n                  <span\n                    role="tooltip"\n                    aria-hidden="true"\n                    class="absolute left-1/2 top-full mt-1 hidden w-max -translate-x-1/2 rounded-lg bg-navy-blue px-3 py-2 text-sm font-medium text-white shadow-md group-hover:block"\n                  >\n                    The last 3-4 digits on the back of the card\n                  </span>\n                </button>\n              </label>\n              <input\n                type="text"\n                id="cvv-input"\n                maxlength="4"\n                placeholder="â€¢â€¢â€¢"\n                class="form-input"\n                inputmode="numeric"\n                aria-required="true"\n                aria-describedby="cvv-description"\n              />\n              <span id="cvv-description" class="sr-only">\n                Enter the 3-digit security code found on the back of your card.\n              </span>\n            </div>\n          </div>\n\n          \x3c!-- Submit Button --\x3e\n          <button\n            type="submit"\n            aria-label="Register"\n            class="btn btn-primary w-full"\n          >\n            Submit\n          </button>\n        </form>\n      </div>\n    </div>\n  </div>\n\n  <span id="error" class="error" role="alert"></span>\n</section>\n\n\x3c!-- Modal container for ModalService --\x3e\n<div id="cardReaderModalContainer"></div>\n\n',"./store-card/store-card.template.html":'<div class="mx-auto max-w-screen-xl px-4 2xl:px-0 transition-transform duration-300 hover:scale-105 hover:shadow-lg cursor-pointer" id="id-{storeId}">\n  <div class="mx-auto max-w-5xl">\n    <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\n      <div class="border p-6 rounded-lg shadow-md w-full">\n        <h2 class="text-lg font-semibold mb-4 text-navy-blue">\n          Store Details\n        </h2>\n\n        <div class="mb-4 grid grid-cols-1 sm:grid-cols-2 gap-4">\n          <div>\n            <p class="text-sm font-medium text-gray-600">Store Name</p>\n            <p class="text-base font-semibold text-gray-900">{storeName}</p>\n          </div>\n          \x3c!-- <div>\n            <p class="text-sm font-medium text-gray-600">Store ID</p>\n            <p class="text-base font-semibold text-gray-900">{storeId}</p>\n          </div> --\x3e\n          <div>\n            <p class="text-sm font-medium text-gray-600">Store Number</p>\n            <p class="text-base font-semibold text-gray-900">{storeNumber}</p>\n          </div>\n          <div>\n            <p class="text-sm font-medium text-gray-600">Fuel Brand</p>\n            <p class="text-base font-semibold text-gray-900">{fuelBrand}</p>\n          </div>\n          <div>\n            <p class="text-sm font-medium text-gray-600">Phone</p>\n            <p class="text-base font-semibold text-gray-900">{phone}</p>\n          </div>\n          <div>\n            <p class="text-sm font-medium text-gray-600">Number of Pumps</p>\n            <p class="text-base font-semibold text-gray-900">{numberOfPumps}</p>\n          </div>\n          <div>\n            <p class="text-sm font-medium text-gray-600">Online Status</p>\n            <p class="text-base font-semibold text-green-600">\n              {isOnline}\n            </p>\n          </div>\n        </div>\n\n        <div class="mt-4 border-t pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">\n          <div>\n            <p class="text-sm font-medium text-gray-600">Address</p>\n            <p class="text-base font-semibold text-gray-900">\n              {streetAddress}, {city}, {stateCode}\n            </p>\n          </div>\n          <div>\n            <p class="text-sm font-medium text-gray-600">Geo Location</p>\n            <p class="text-base font-semibold text-gray-900">\n              Lat: {latitude}, Long: {longitude}\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n',"./stores/stores.template.html":'<section class="container py-8">\n  <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\n    <h1 class="text-2xl font-bold mb-6 text-navy-blue">Available Stores</h1>\n\n    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">\n      \x3c!-- Loop through stores and render store-card --\x3e\n     \n        {stores}\n      </div>\n      \n     \n    </div>\n  </section>\n  '})}}class CardReaderComponent extends BaseComponent{constructor(e,t,n,s){super(e),__publicField(this,"videoElement"),__publicField(this,"cardReaderContainer"),__publicField(this,"processingIndicator"),__publicField(this,"cameraErrorElement"),__publicField(this,"scanErrorMessage"),__publicField(this,"stream",null),__publicField(this,"canvas"),__publicField(this,"extractedCardNumber",""),__publicField(this,"extractedExpirationDate",""),__publicField(this,"cardholderName",""),__publicField(this,"cvv",""),__publicField(this,"onCardDataExtracted"),__publicField(this,"onManualEntry"),__publicField(this,"boundHandleVideoClick",null),__publicField(this,"captureIntervalId",null),__publicField(this,"isProcessing",!1),__publicField(this,"isClosed",!1),__publicField(this,"mode","auto"),__publicField(this,"captureIntervalMs",Number(void 0)||300),this.onCardDataExtracted=t,this.onManualEntry=n,this.canvas=document.createElement("canvas"),(null==s?void 0:s.mode)&&(this.mode=s.mode),(null==s?void 0:s.intervalMs)&&(this.captureIntervalMs=s.intervalMs)}async init(){this.isClosed=!1,this.isProcessing=!1,this.initializeElements(),this.setupEventListeners();try{if(await this.initCamera(),!this.stream)throw new Error("Camera stream not available");await this.waitForVideoReady()}catch(e){return}"auto"===this.mode&&this.startAutoCapture()}clean(){this.stopAutoCapture(),this.stopCameraStream(),this.removeEventListeners(),this.resetState(),this.isClosed=!0,this.isProcessing=!1}initializeElements(){this.videoElement=this.$("#camera-feed"),this.cardReaderContainer=this.$(".card-scanner-fullscreen"),this.processingIndicator=this.$("#processing-indicator"),this.cameraErrorElement=this.$("#camera-error"),this.scanErrorMessage=this.$("#scan-error-message")}setupEventListeners(){this.boundHandleVideoClick=this.handleVideoClick.bind(this);const e=this.$(".camera-viewport");e&&e.addEventListener("click",this.boundHandleVideoClick);const t=this.$(".card-scanner-fullscreen");t&&t.addEventListener("click",(async e=>{var t;if("manual"!==this.mode)return;const n=e.target,s="close-scanner"===n.id||!!n.closest&&!!n.closest("#close-scanner"),a=(null==(t=n.classList)?void 0:t.contains("manual-entry-text"))||!!n.closest&&!!n.closest(".manual-entry-text");s||a||await this.captureAndProcess("manual")}));const n=this.$(".manual-entry-text");n&&n.addEventListener("click",(()=>{this.onManualEntry&&this.onManualEntry()}));const s=this.$("#close-scanner");s&&s.addEventListener("click",(()=>{this.close()}))}removeEventListeners(){if(this.boundHandleVideoClick){const e=this.$(".camera-viewport");e&&e.removeEventListener("click",this.boundHandleVideoClick),this.boundHandleVideoClick=null}}async initCamera(){try{this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}),this.videoElement.srcObject=this.stream,this.hideElement(this.cameraErrorElement)}catch(e){this.showElement(this.cameraErrorElement)}}async waitForVideoReady(){this.videoElement.readyState>=2&&this.videoElement.videoWidth>0||await new Promise(((e,t)=>{const onLoaded=()=>{e(),this.videoElement.removeEventListener("loadedmetadata",onLoaded),this.videoElement.removeEventListener("loadeddata",onLoaded),this.videoElement.removeEventListener("playing",onLoaded),this.videoElement.removeEventListener("error",onError)},onError=e=>{this.videoElement.removeEventListener("error",onError),this.videoElement.removeEventListener("loadedmetadata",onLoaded),this.videoElement.removeEventListener("loadeddata",onLoaded),this.videoElement.removeEventListener("playing",onLoaded),t(new Error("Video failed to load"))};this.videoElement.addEventListener("loadedmetadata",onLoaded),this.videoElement.addEventListener("loadeddata",onLoaded),this.videoElement.addEventListener("playing",onLoaded),this.videoElement.addEventListener("error",onError)}))}startAutoCapture(){this.stopAutoCapture(),(async()=>{this.isClosed||this.isProcessing||await this.captureAndProcess("auto")})(),this.captureIntervalId=window.setInterval((async()=>{this.isClosed||this.isProcessing||await this.captureAndProcess("auto")}),this.captureIntervalMs)}stopAutoCapture(){null!==this.captureIntervalId&&(window.clearInterval(this.captureIntervalId),this.captureIntervalId=null)}async handleVideoClick(){"manual"===this.mode?await this.captureAndProcess("manual"):this.isProcessing||await this.captureAndProcess("auto")}stopCameraStream(){var e;null==(e=this.stream)||e.getTracks().forEach((e=>e.stop())),this.stream=null}resetState(){this.extractedCardNumber="",this.extractedExpirationDate="",this.cardholderName="",this.cvv="",this.hideElement(this.scanErrorMessage),this.hideElement(this.processingIndicator)}captureCurrentFrame(){if(!this.stream)return null;const{videoWidth:e,videoHeight:t}=this.videoElement;if(!e||!t)return null;this.canvas.width=e,this.canvas.height=t;const n=this.canvas.getContext("2d");return n?(n.drawImage(this.videoElement,0,0,e,t),this.canvas.toDataURL("image/jpeg",.8)):null}async captureAndProcess(e){try{this.isProcessing=!0,"manual"===e&&this.showElement(this.processingIndicator),this.hideElement(this.scanErrorMessage);const t=this.captureCurrentFrame();if(!t)return void this.handleProcessingError("Unable to capture image");const n=await this.apiService.getCardInfo(t);this.extractedCardNumber=n.cardNumber||"",this.extractedExpirationDate=n.expDate||"",this.cardholderName=n.cardholderName||"",this.cvv=n.cvv||"","auto"===e?this.extractedCardNumber&&this.acceptResults():this.acceptResults()}catch(t){this.handleProcessingError("Error processing card image")}finally{this.isProcessing=!1,"manual"===e&&this.hideElement(this.processingIndicator)}}handleProcessingError(e){this.scanErrorMessage.textContent=e,this.showElement(this.scanErrorMessage)}acceptResults(){this.onCardDataExtracted(this.extractedCardNumber,this.extractedExpirationDate,this.cardholderName,this.cvv)}getCardData(){return this.extractedCardNumber&&this.extractedExpirationDate?{cardNumber:this.extractedCardNumber,expirationDate:this.extractedExpirationDate,cardholderName:this.cardholderName,cvv:this.cvv}:null}reset(){this.resetState(),"auto"===this.mode&&this.startAutoCapture()}close(){this.clean(),this.cardReaderContainer&&this.cardReaderContainer.remove()}showElement(e){e.classList.remove("hidden"),e.classList.add("flex")}hideElement(e){e.classList.add("hidden"),e.classList.remove("flex")}}const V=class _GlobalErrorHandlerService{constructor(){__publicField(this,"notificationService"),__publicField(this,"isInitialized",!1),__publicField(this,"handleError",(e=>{var t,n;let s;s=e instanceof ErrorEvent?(null==(t=e.error)?void 0:t.message)||e.message||"An unexpected error occurred":(null==(n=e.reason)?void 0:n.message)||e.reason||"An unhandled promise rejection occurred",this.notificationService.push("error",s,8e3)})),this.notificationService=o.getInstance()}static getInstance(){return _GlobalErrorHandlerService.instance||(_GlobalErrorHandlerService.instance=new _GlobalErrorHandlerService),_GlobalErrorHandlerService.instance}static getErrorMessage(e,t="",n="unknown error"){let s;return s=e?"string"==typeof e?e:e instanceof Error||"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:JSON.stringify(e):n,`${t}${s}`}static isWrongCredentialsError(e){return e instanceof ApiError&&e.statusCode===n.WRONG_CREDENTIALS}initialize(){this.isInitialized||(window.addEventListener("error",(e=>{var t;const n=(null==(t=e.error)?void 0:t.message)||e.message||"An unexpected error occurred";this.notificationService.push("error",n,8e3)})),window.addEventListener("unhandledrejection",(e=>{var t;const n=(null==(t=e.reason)?void 0:t.message)||e.reason||"An unhandled promise rejection occurred";this.notificationService.push("error",n,8e3)})),this.isInitialized=!0)}destroy(){this.isInitialized&&(window.removeEventListener("error",this.handleError),window.removeEventListener("unhandledrejection",this.handleError),this.isInitialized=!1)}};__publicField(V,"instance");let U=V;class ModalService{constructor(e,t){__publicField(this,"modalsState",{}),__publicField(this,"onToggleCallback"),this.getModalTemplate=e,this.onToggleCallback=t}toggleModal(e){if(e in this.modalsState||(this.modalsState[e]=!1),this.modalsState[e]=!this.modalsState[e],this.updateModalUI(e),this.onToggleCallback){const t=this.modalsState[e]?"open":"close";this.onToggleCallback(e,t)}}updateModalUI(e){const t=document.getElementById(`${e}Container`);t&&(t.innerHTML="",t.innerHTML=this.modalsState[e]?this.getModalTemplate(e):"",this.attachModalEvent(e))}attachModalEvent(e){var t;null==(t=document.getElementById(`${e}Close`))||t.addEventListener("click",(()=>{this.modalsState[e]=!1,this.updateModalUI(e),this.onToggleCallback&&this.onToggleCallback(e,"close")}))}}class RegisterFormComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"form"),__publicField(this,"errorSpan"),__publicField(this,"cardNumberInput"),__publicField(this,"expInput"),__publicField(this,"cvvInput"),__publicField(this,"phoneInput"),__publicField(this,"scanCardBtn"),__publicField(this,"cardReaderContent"),__publicField(this,"numberOfPumps"),__publicField(this,"resetPassword",!1),__publicField(this,"cardReaderComponent"),__publicField(this,"modalService"),this.numberOfPumps=this.state.numberOfPumps,this.cardReaderComponent=new CardReaderComponent(this.store,this.onCardDataExtracted.bind(this),(()=>{this.cardReaderComponent.close(),this.modalService.toggleModal("cardReaderModal")})),this.modalService=new ModalService(this.getModalTemplate.bind(this),this.handleModalToggle.bind(this))}onCardDataExtracted(e,t,n,s){this.cardReaderComponent.close(),this.modalService.toggleModal("cardReaderModal"),this.cardNumberInput.value=e,this.expInput.value=t,this.cvvInput.value=s,this.handleCardNumberInput()}attachEventsInternal(){this.form=this.$("form"),this.errorSpan=this.$("#error"),this.cardNumberInput=this.$("#card-number-input"),this.expInput=this.$("#card-expiration-input"),this.phoneInput=this.$("#mobile-phone-input"),this.scanCardBtn=this.$("#scan-card-btn"),this.cvvInput=this.$("#cvv-input"),this.populatePumpDropdown(),this.preventNonNumericValues(this.form,["#card-number-input","#zipcode","#cvv-input","#mobile-phone-input"]),this.setupInputFormatting(),this.form.addEventListener("submit",(e=>this.handleSubmit(e))),this.scanCardBtn.addEventListener("click",(()=>this.handleScanCardClick()))}handleModalToggle(e,t){"cardReaderModal"===e&&("open"===t?(this.cardReaderContent=this.$("#card-reader-content"),this.cardReaderContent&&(this.cardReaderContent.innerHTML=this.cardReaderComponent.render(),this.cardReaderComponent.init())):"close"===t&&(this.cardReaderContent=null))}handleScanCardClick(){this.modalService.toggleModal("cardReaderModal")}getModalTemplate(e){return"cardReaderModal"===e?'<div id="card-reader-content"></div>':""}populatePumpDropdown(){const e=this.$("#pump-number");e.innerHTML="";for(let t=1;t<=this.numberOfPumps;t++){const n=document.createElement("option");n.value=t.toString(),n.textContent=`Pump ${t}`,e.appendChild(n)}}validate(e){return validate(B,e)}async handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.errorSpan.innerHTML="";const n=this.getFormData(),s=this.validate(n);if(Object.keys(s).length>0)this.errorSpan.innerHTML=Object.values(s).flat().map((e=>"<div>"+e+"</div>")).join("");else{this.displayLoading();try{const{phone:e,creditCard:s,...a}=n,{_id:i}=await this.apiService.registerCustomer(e,s,Object.keys(a).length?a:void 0,this.resetPassword);this.store.setState({...n,customerId:i,phone:n.phone,chosenPumpNumber:Number(this.$("#pump-number").value??0)}),this.store.transitionTo(t.IN_OTP_FORM)}catch(a){U.isWrongCredentialsError(a)?this.errorSpan.textContent="You are using wrong credentials you can reset your password":this.errorSpan.textContent=U.getErrorMessage(a)}finally{this.hideLoading()}}}getFormData(){return{phone:this.phoneInput.value,creditCard:{cardNumber:this.cardNumberInput.value.replace(/\s/g,""),exp:this.expInput.value,zipCode:this.$("#zipcode").value,cvv:this.$("#cvv-input").value}}}setupInputFormatting(){this.cardNumberInput.addEventListener("input",(()=>this.handleCardNumberInput())),this.expInput.addEventListener("input",(()=>this.handleExpInput()))}handleCardNumberInput(){const e=this.cardNumberInput.value.replace(/\D/g,"").slice(0,16);this.cardNumberInput.value=e.replace(/(\d{4})(?=\d)/g,"$1 ").trim()}handleExpInput(){const e=this.expInput.value.replace(/\D/g,"").slice(0,4);this.expInput.value=e.length>=3?`${e.slice(0,2)}/${e.slice(2)}`:e}}var q=(e=>(e.DEFAULT="default",e.FULL="full",e.LOGIN="login",e))(q||{});const W={[q.DEFAULT]:t.REGISTER_FORM,[q.FULL]:t.REGISTER_EXTENDED_FORM,[q.LOGIN]:t.LOGIN_FORM};class StoreCardComponent extends PageBaseComponent{constructor(e,t={}){super(e),__publicField(this,"card"),this.storeData=t}templateData(){var e,t,n,s,a,i,r,o,d,l,c;return{...this.storeData,streetAddress:(null==(t=null==(e=this.storeData)?void 0:e.address)?void 0:t.streetAddress)||"unkown street",city:(null==(s=null==(n=this.storeData)?void 0:n.address)?void 0:s.city)||"unkown city",stateCode:(null==(i=null==(a=this.storeData)?void 0:a.address)?void 0:i.stateCode)||"unkown state",latitude:(null==(o=null==(r=this.storeData)?void 0:r.geoLocation)?void 0:o.latitude)||"00",longitude:(null==(l=null==(d=this.storeData)?void 0:d.geoLocation)?void 0:l.longitude)||"00",isOnline:(null==(c=this.storeData)?void 0:c.isOnline)?"Online":"Offline"}}attachEventsInternal(){this.card=this.$(`#id-${this.storeData.storeId}`),this.card.addEventListener("click",(()=>this.handleCardClick()))}handleCardClick(){this.store.setState({chosenStoreId:this.storeData.storeId??"",chosenStorePosition:this.storeData.geoLocation,numberOfPumps:this.storeData.numberOfPumps??0});const e=function(){const e=new URLSearchParams(window.location.search).get("mode")||q.DEFAULT;return Object.values(q).includes(e)?e:q.DEFAULT}();this.store.transitionTo(W[e])}}class StoresComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"stores",[]),__publicField(this,"cardsComponents",[]),this.stores=this.state.stores,this.cardsComponents=this.stores.map((e=>new StoreCardComponent(this.store,e)))}getStoreCards(){return this.cardsComponents.map((e=>e.render())).join("")}templateData(){return{stores:this.getStoreCards()}}attachEventsInternal(){this.cardsComponents.forEach((e=>{e.attachEvents()}))}}const H=B.extend({firstName:M().min(1,{message:"First name is required"}).refine((e=>/^[A-Za-z]+$/.test(e)),{message:"First name must contain only letters"}),lastName:M().min(1,{message:"Last name is required"}).refine((e=>/^[A-Za-z]+$/.test(e)),{message:"Last name must contain only letters"}),email:M().min(1,{message:"Email is required"}).email({message:"Email must be a valid email address"}),password:M().min(8,{message:"Password must be at least 8 characters long, contain at least one letter and one number, and have no spaces"}).regex(/^(?=.*[a-zA-Z])(?=.*\d)[^\s]{8,}$/,{message:"Password must be at least 8 characters long, contain at least one letter and one number, and have no spaces"}),pinCode:M().length(4,{message:"PIN code must be a 4-digit number"}).refine((e=>/^\d+$/.test(e)),{message:"PIN code must contain only digits"})}),K=F({email:M().min(1,{message:"Email is required"}).email({message:"Email must be a valid email address"})});class ExtendedRegisterFormComponent extends RegisterFormComponent{constructor(e){super(e),__publicField(this,"firstNameInput"),__publicField(this,"lastNameInput"),__publicField(this,"emailInput"),__publicField(this,"passwordInput"),__publicField(this,"pinCodeInput"),__publicField(this,"resetPasswordButton"),__publicField(this,"passwordLabel"),__publicField(this,"passwordDescription")}attachEventsInternal(){super.attachEventsInternal(),this.firstNameInput=this.$("#first-name"),this.lastNameInput=this.$("#last-name"),this.emailInput=this.$("#email"),this.passwordInput=this.$("#password"),this.pinCodeInput=this.$("#pin-code"),this.resetPasswordButton=this.$("#reset-password-button"),this.passwordLabel=this.$("#password-label"),this.passwordDescription=this.$("#password-description"),this.resetPasswordButton.addEventListener("click",(()=>this.handleResetPasswordButtonClick())),this.preventNonNumericValues(this.form,["#pin-code"])}validate(e){return validate(H,e)}async handleResetPasswordButtonClick(){this.errorSpan.innerHTML="";try{const e=this.getFormData(),t=validate(K,{email:e.email});if(Object.keys(t).length>0)return void(this.errorSpan.innerHTML=Object.values(t).flat().map((e=>"<div>"+e+"</div>")).join(""));this.displayLoading(),await this.apiService.resetPassword(e.email),this.resetPassword=!0,this.passwordLabel.textContent="Password or Reset Link*",this.passwordDescription.textContent="Please enter your password or the password reset link that was just emailed to you.",this.passwordInput.type="text"}catch(e){this.errorSpan.textContent=U.getErrorMessage(e)}finally{this.hideLoading()}}getFormData(){return{...super.getFormData(),firstName:this.firstNameInput.value.trim(),lastName:this.lastNameInput.value.trim(),email:this.emailInput.value.trim(),password:this.passwordInput.value,pinCode:this.pinCodeInput.value}}}class OtpFormComponent extends PageBaseComponent{constructor(){super(...arguments),__publicField(this,"inputs"),__publicField(this,"errorSpan"),__publicField(this,"form")}attachEventsInternal(){this.inputs=this.$_all('input[name^="otp"]'),this.errorSpan=this.$("#error"),this.form=this.$("form"),this.inputs.forEach(((e,t)=>{e.addEventListener("input",(()=>this.handleInput(e,t))),e.addEventListener("keydown",(e=>this.handleBackspace(e,t))),e.addEventListener("paste",(e=>this.handlePaste(e)))})),this.form.addEventListener("submit",(e=>this.handleSubmit(e)))}handleInput(e,t){e.value=e.value.slice(0,1);const n=this.inputs[t+1];e.value&&n&&n.focus()}handleBackspace(e,t){const n=e.target;if("Backspace"===e.key){if(""===n.value){const e=this.inputs[t-1];e&&e.focus()}else n.value="";e.preventDefault()}}handlePaste(e){var t;e.preventDefault();const n=((null==(t=e.clipboardData)?void 0:t.getData("text"))||"").replace(/\D/g,"").split("");n.length===this.inputs.length&&this.inputs.forEach(((e,t)=>e.value=n[t]||""))}async handleSubmit(e){e.preventDefault(),this.errorSpan.innerHTML="";const n=this.getFormData();if(n.length===this.inputs.length)try{await this.apiService.verifySmsToken(this.state.customerId,n,{position:this.state.chosenStorePosition||this.state.position,storeId:this.state.chosenStoreId,pumpNumber:this.state.chosenPumpNumber}),this.store.transitionTo(t.FINAL)}catch(s){this.errorSpan.textContent=U.getErrorMessage(s)}else this.errorSpan.innerHTML="OTP must be 6 digits"}getFormData(){return Array.from(this.inputs).map((e=>e.value)).join("")}}class CanceledComponent extends BaseComponent{constructor(e,t){super(e),__publicField(this,"message"),this.message=t}templateData(){return{message:this.message}}}class ErrorComponent extends CanceledComponent{buildTemplatePath(){return"./canceled/canceled.template.html"}}class FinalComponent extends PageBaseComponent{}const G=F({phone:M().length(10,{message:"Phone number must be a numeric value with 10 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Phone number must contain only digits"}),pumpNumber:D({message:"Pump number must be a positive"}).min(1)});class LoginFormComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"form"),__publicField(this,"errorSpan"),__publicField(this,"phoneInput"),__publicField(this,"pumpDropdown"),__publicField(this,"numberOfPumps"),this.numberOfPumps=this.state.numberOfPumps}attachEvents(){this.form=this.$("form"),this.errorSpan=this.$("#error"),this.phoneInput=this.$("#mobile-phone-input"),this.pumpDropdown=this.$("#pump-number"),this.populatePumpDropdown(),this.preventNonNumericValues(this.form,["#mobile-phone-input"]),this.form.addEventListener("submit",(e=>this.handleSubmit(e)))}populatePumpDropdown(){this.pumpDropdown.innerHTML="";for(let e=1;e<=this.numberOfPumps;e++){const t=document.createElement("option");t.value=e.toString(),t.textContent=`Pump ${e}`,this.pumpDropdown.appendChild(t)}}async handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.errorSpan.textContent="";const n=this.getFormData(),s=validate(G,n);if(Object.keys(s).length>0)this.errorSpan.textContent=Object.values(s)[0][0];else try{const{_id:e,success:s}=await this.apiService.loginCustomer({...n,...this.state.position,storeId:this.state.chosenStoreId});if(s)return void this.store.transitionTo(t.FINAL);this.store.setState({phone:n.phone,customerId:e,chosenPumpNumber:n.pumpNumber}),this.store.transitionTo(t.IN_OTP_FORM)}catch(a){this.errorSpan.textContent=(null==a?void 0:a.message)||a}}getFormData(){return{phone:this.phoneInput.value,pumpNumber:Number(this.pumpDropdown.value)}}}class Renderer{constructor(e){__publicField(this,"appElement"),__publicField(this,"currentComponent",null),__publicField(this,"messages",{cancel:"Please see an attendant inside to pay for fuel",error:"Something went wrong, please see an attendant inside to pay for fuel"}),this.componentFactory=e,this.appElement=document.getElementById("app"),o.getInstance()}update(e,t){this.appElement&&(this.currentComponent=this.componentFactory(e.state,t),this.appElement.innerHTML=this.currentComponent.render(),this.currentComponent.attachEvents())}}class Store{constructor(e,t,n,s){__publicField(this,"subscriber",null),__publicField(this,"OTP_COOKIE_KEY","otpState"),__publicField(this,"storeCookieStates"),__publicField(this,"deleteCookieState"),__publicField(this,"excludeFromCookie"),__publicField(this,"initialState"),__publicField(this,"state"),this.initialState=e,this.state=this.initialState,this.storeCookieStates=t,this.deleteCookieState=n,this.excludeFromCookie=s,this.loadStoredState()}getState(){return this.state}setState(e){this.state={...this.state,...e}}transitionTo(e){this.state.state=e,this.storeCookieStates.includes(e)?this.storeOtpState():e===this.deleteCookieState&&this.deleteStoredState(),this.notifySubscriber()}storeOtpState(){const e=(t=this.state,n=this.excludeFromCookie,Object.fromEntries(Object.entries(t).filter((([e])=>!n.includes(e)))));var t,n;const s="https:"===window.location.protocol;document.cookie=`${this.OTP_COOKIE_KEY}=${encodeURIComponent(JSON.stringify(e))};path=/;max-age=120${s?";secure":""}`}subscribe(e){this.subscriber=e}notifySubscriber(){this.subscriber&&this.subscriber.update(this.state,this)}setInitialState(){this.setState(this.initialState)}loadStoredState(){const e=this.getCookie(this.OTP_COOKIE_KEY);if(e)try{const t=JSON.parse(decodeURIComponent(e));this.state={...this.initialState,...t},this.notifySubscriber()}catch{this.state=this.initialState}}deleteStoredState(){document.cookie=`${this.OTP_COOKIE_KEY}=;path=/;max-age=0;`}getCookie(e){const t=document.cookie.match(new RegExp(`(^| )${e}=([^;]+)`));return t?t[2]:null}}const Y={state:t.INITIAL,position:{longitude:"",latitude:""},stores:[],chosenStoreId:"",chosenStorePosition:{latitude:"",longitude:""},numberOfPumps:0,chosenPumpNumber:0,creditCard:{cardNumber:"",exp:"",zipCode:"",cvv:""},phone:"",customerId:""};window.addEventListener("load",(async function(){U.getInstance().initialize();const e=new ApiService,n=new Store(Y,[t.IN_OTP_FORM],t.FINAL,["creditCard","stores"]),s=new Renderer(function(){const e={[t.INITIAL]:e=>new InitialComponent(e),[t.REGISTER_FORM]:e=>new RegisterFormComponent(e),[t.STORES_PAGE]:e=>new StoresComponent(e),[t.REGISTER_EXTENDED_FORM]:e=>new ExtendedRegisterFormComponent(e),[t.LOGIN_FORM]:e=>new LoginFormComponent(e),[t.IN_OTP_FORM]:e=>new OtpFormComponent(e),[t.ERROR]:e=>new ErrorComponent(e,"Something went wrong, please see an attendant inside to pay for fuel"),[t.FINAL]:e=>new FinalComponent(e)};return(n,s)=>e[n]?e[n](s):e[t.ERROR](s)}());n.subscribe(s);const a=l.getInstance();a.show();const i=n.getState().state;if(i!==t.INITIAL)return n.transitionTo(i),void a.hide();async function getStores(s){try{a.show();const{data:i}=await e.listStores(s);n.setState({stores:i??[]}),n.transitionTo(t.STORES_PAGE)}catch(i){o.getInstance().push("error","Failed to load stores. Please try again."+U.getErrorMessage(i))}finally{a.hide()}}try{navigator.geolocation.getCurrentPosition((async function(e){n.setState({position:{longitude:`${e.coords.longitude}`,latitude:`${e.coords.latitude}`}}),n.transitionTo(t.INITIAL),await getStores(n.getState().position)}),(async function(){n.setState({position:{longitude:"28.186879730583183",latitude:"-82.40479285767222"}}),n.transitionTo(t.INITIAL),await getStores(n.getState().position)}))}catch(r){o.getInstance().push("error",U.getErrorMessage(r)),a.hide()}}));
