var e=Object.defineProperty,__publicField=(t,r,n)=>((t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n)(t,"symbol"!=typeof r?r+"":r,n);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))processPreload(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&processPreload(e)})).observe(document,{childList:!0,subtree:!0})}function processPreload(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var t=(e=>(e.INITIAL="initial",e.STORES_PAGE="stores-page",e.REGISTER_FORM="register-form",e.REGISTER_EXTENDED_FORM="register-extended-form",e.LOGIN_FORM="login-form",e.IN_OTP_FORM="otp-form",e.FINAL="final",e.ERROR="error",e))(t||{});class ApiError extends Error{constructor(e,t){super(e),this.message=e,this.statusCode=t,this.name="ApiError"}}var r=(e=>(e[e.WRONG_CREDENTIALS=414]="WRONG_CREDENTIALS",e[e.EXPIRED_TOKENS=413]="EXPIRED_TOKENS",e))(r||{});var n=(e=>(e.CLOUD_VISION="cloud-vision",e.GEMINI="gemini",e))(n||{});const s={[n.CLOUD_VISION]:10,[n.GEMINI]:10};var a=(e=>(e.PHONE_ONLY="phone-only",e.FULL_DATA="full-data",e))(a||{});class ApiService{constructor(){__publicField(this,"API_BASE_URL","https://stg-bmp-api.billmyplate.com")}async fetchConfirmationData(e,t){try{if(!e||!t)throw new Error("Invalid merchantId or pumpNumber");const r=await fetch(`${this.API_BASE_URL}/event/plate-detection/latest?merchantId=${e}&pumpNumber=${t}`);if(!r.ok)throw new ApiError(`Request failed: ${r.statusText}`,r.status);return await r.json()}catch(r){throw r}}async registerCustomer(e,t,n,s){if(!e||!t)throw new Error("Missing phone or creditCard");try{const i={registrationType:n?a.FULL_DATA:a.PHONE_ONLY,phone:e,creditCard:t,...n?{...n,isWithPassword:Boolean(s)}:{}},o=await fetch(`${this.API_BASE_URL}/customer/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!o.ok){const e=await o.json().catch((()=>({})));if("CUSTOMER_WRONG_LOGIN_OR_PASSWORD"===(null==e?void 0:e.message))throw new ApiError(e.message,r.WRONG_CREDENTIALS);throw new ApiError(e.message||`Request failed: ${o.statusText}`,o.status)}return await o.json()}catch(i){throw i}}async verifySmsToken(e,t,r,n){try{if(!e||!t)throw new Error("Missing id or token");const{position:s,...a}=r||{},i=await fetch(`${this.API_BASE_URL}/customer/verify`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,token:t,plate:n,...r?{pumpData:{...a,...s}}:{}})});if(!i.ok)throw new ApiError(`Request failed: ${i.statusText}`,i.status);return await i.json()}catch(s){throw s}}async loginCustomer(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/login-auth-pump`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();if("Expired Tokens"===(null==e?void 0:e.message))throw new ApiError(e.message,r.EXPIRED_TOKENS);throw new ApiError(e.message||`Request failed: ${t.statusText}`,t.status)}return await t.json()}catch(t){throw t}}async listStores(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/stores?longitude=${e.longitude}&latitude=${e.latitude}`,{method:"GET",headers:{"Content-Type":"application/json"}});return await t.json()}catch(t){throw t}}async resetPassword(e){try{const t=await fetch(`${this.API_BASE_URL}/customer/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!t.ok)throw new ApiError(`Request failed: ${t.statusText}`,t.status);return}catch(t){throw t}}async getCardInfo(e,t=6e4){const r=function(e){const t=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),s=new Uint8Array(n);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return new Blob([n],{type:r})}(e),a=new FormData;a.append("image",r,"card.jpeg");const i="gemini";if(o=i,!Object.values(n).includes(o))throw new Error("Invalid card reader provider");var o;const d=1024*s[i]*1024;if(r.size>d)throw new Error(`Image size is too large, Maximum allowed size is ${s[i]}MB.`);const l=new AbortController,c=setTimeout((()=>l.abort()),t);try{const e=await fetch(`${this.API_BASE_URL}/customer/read-card-info?provider=${i}`,{method:"POST",body:a,signal:l.signal});if(!e.ok)throw new Error(`Error ${e.statusText}`);return await e.json()}catch(u){if("AbortError"===(null==u?void 0:u.name))throw new Error("Request timed out");throw u}finally{clearTimeout(c)}}}class NotificationService{constructor(e,t){__publicField(this,"notification"),__publicField(this,"element"),__publicField(this,"onRemove"),__publicField(this,"template",'<div class="notification-box notification-{type}" data-notification-id="{id}" style="display: flex; align-items: center; justify-content: space-between; padding: 16px; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.12); position: relative; font-family: inherit; font-size: 15px; margin: 0; min-width: 220px; max-width: 100%; word-break: break-word; transform: translateX(0); opacity: 1; transition: transform 0.3s ease-out, opacity 0.3s ease-out; {boxStyle}">\r\n    <span>{message}</span>\r\n    <button class="notification-close-btn" style="background: transparent; border: none; color: inherit; font-size: 20px; cursor: pointer; margin-left: 16px;">Ã—</button>\r\n    <div class="notification-bar" style="position: absolute; left: 0; bottom: 0; height: 4px; width: 100%; transition: width 0.1s linear; background: {barColor};"></div>\r\n</div>'),this.notification=e,this.onRemove=t}render(){return this.processTemplate(this.template,{id:this.notification.id,type:this.notification.type,message:this.notification.message,barColor:this.getBarColor(this.notification.type),boxStyle:this.getBoxStyle(this.notification.type)})}attachEvents(e){if(this.element=e.querySelector(`[data-notification-id="${this.notification.id}"]`),this.element){const e=this.element.querySelector(".notification-close-btn");e&&e.addEventListener("click",(()=>{this.remove()})),this.addEntranceAnimation()}}remove(){this.element&&(this.element.style.transition="transform 0.3s ease-in, opacity 0.3s ease-in",this.element.style.transform="translateX(100%)",this.element.style.opacity="0",setTimeout((()=>{var e,t;null==(e=this.element)||e.remove(),null==(t=this.onRemove)||t.call(this,this.notification.id)}),300))}addEntranceAnimation(){this.element&&(this.element.style.transform="translateX(100%)",this.element.style.opacity="0",this.element.style.transition="transform 0.3s ease-out, opacity 0.3s ease-out",requestAnimationFrame((()=>{this.element&&(this.element.style.transform="translateX(0)",this.element.style.opacity="1")})))}updateProgress(e){var t;const r=null==(t=this.element)?void 0:t.querySelector(".notification-bar");r&&(r.style.width=e+"%")}getNotification(){return this.notification}getBarColor(e){return"error"===e?"#e53935":"warning"===e?"#fbc02d":"#43a047"}getBoxStyle(e){return"error"===e?"background: #ffebee; color: #b71c1c; border: 1px solid #e53935;":"warning"===e?"background: #fffde7; color: #f57c00; border: 1px solid #fbc02d;":"background: #e8f5e9; color: #1b5e20; border: 1px solid #43a047;"}processTemplate(e,t){return e.replace(/\{([^{}]+)\}/g,((e,r)=>r.trim()in t?t[r.trim()]:""))}}const i=class _NotificationWrapperService{constructor(){__publicField(this,"notifications",[]),__publicField(this,"notificationInstances",[]),__publicField(this,"nextId",1),__publicField(this,"container"),__publicField(this,"intervalId",null),this.container=this.ensureContainer(),this.render(),this.startTimer()}static getInstance(){return _NotificationWrapperService.instance||(_NotificationWrapperService.instance=new _NotificationWrapperService),_NotificationWrapperService.instance}push(e,t,r=5e3){const n={id:this.nextId++,type:e,message:t,duration:r,createdAt:Date.now()};this.notifications.push(n);const s=new NotificationService(n,(e=>this.remove(e)));this.notificationInstances.push(s),this.container.insertAdjacentHTML("beforeend",s.render()),s.attachEvents(this.container)}remove(e){const t=this.notificationInstances.findIndex((t=>t.getNotification().id===e));if(-1!==t){this.notificationInstances[t].remove(),setTimeout((()=>{this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e)),this.notifications=this.notifications.filter((t=>t.id!==e))}),300)}else this.notifications=this.notifications.filter((t=>t.id!==e)),this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e))}ensureContainer(){let e=document.getElementById("notification-wrapper");return e||(e=document.createElement("div"),e.id="notification-wrapper",e.style.position="fixed",e.style.bottom="20px",e.style.right="20px",e.style.zIndex="9999",e.style.display="flex",e.style.flexDirection="column",e.style.gap="12px",e.style.maxWidth="350px",document.body.appendChild(e)),e}render(){this.container.innerHTML="",this.notificationInstances.forEach((e=>{this.container.insertAdjacentHTML("beforeend",e.render()),e.attachEvents(this.container)}))}startTimer(){this.intervalId||(this.intervalId=window.setInterval((()=>{const e=Date.now(),t=[];this.notificationInstances.forEach((r=>{const n=r.getNotification(),s=e-n.createdAt,a=Math.max(0,100-s/n.duration*100);r.updateProgress(a),s>=n.duration&&t.push(n.id)})),t.forEach((e=>{const t=this.notificationInstances.findIndex((t=>t.getNotification().id===e));if(-1!==t){this.notificationInstances[t].remove(),setTimeout((()=>{this.notificationInstances=this.notificationInstances.filter((t=>t.getNotification().id!==e)),this.notifications=this.notifications.filter((t=>t.id!==e))}),300)}}))}),100))}};__publicField(i,"instance");let o=i;const d=class _LoadingOverlayService{constructor(){__publicField(this,"overlay",null),__publicField(this,"visible",!1),this.initializeOverlay()}static getInstance(){return _LoadingOverlayService.instance||(_LoadingOverlayService.instance=new _LoadingOverlayService),_LoadingOverlayService.instance}initializeOverlay(){this.overlay=document.getElementById("global-loading-overlay"),this.overlay}show(){this.overlay&&(this.overlay.style.opacity="1",this.overlay.style.visibility="visible",this.visible=!0)}hide(){this.overlay&&(this.overlay.style.opacity="0",this.overlay.style.visibility="hidden",this.visible=!1)}isVisible(){return this.visible}};__publicField(d,"instance");let l=d;class BaseComponent{constructor(e){__publicField(this,"store"),__publicField(this,"state"),__publicField(this,"apiService",new ApiService),__publicField(this,"notificationWrapper",o.getInstance()),__publicField(this,"templates",Object.assign({"./canceled/canceled.template.html":'<section class="container">\r\n  <div class="col-container">\r\n    <h1 class="heading" id="main-heading">{message}</h1>\r\n\r\n    <button\r\n      id="closeBtn"\r\n      class="btn btn-primary"\r\n      aria-label="Close the form"\r\n      aria-labelledby="main-heading"\r\n    >\r\n      <span>Close</span>\r\n    </button>\r\n  </div>\r\n</section>\r\n',"./card-reader/card-reader.template.html":'\x3c!-- Full Screen Card Scanner --\x3e\r\n<div class="card-scanner-fullscreen">\r\n  \x3c!-- Full screen overlay --\x3e\r\n  <div class="scanner-overlay">\r\n    \x3c!-- Header --\x3e\r\n    <div class="scanner-header">\r\n      <button id="close-scanner" class="close-button" aria-label="Close scanner">\r\n        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\r\n          <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\r\n        </svg>\r\n      </button>\r\n      <h1 class="scanner-title">Add a card</h1>\r\n    </div>\r\n    \r\n    \x3c!-- Main scanning area --\x3e\r\n    <div class="scanner-main">\r\n      \x3c!-- Instruction text --\x3e\r\n      <div class="scanner-instruction">\r\n        <p class="instruction-text">Line it up with the frame.</p>\r\n      </div>\r\n      \r\n      \x3c!-- Camera viewport with single card frame --\x3e\r\n      <div class="camera-viewport">\r\n        <video id="camera-feed" class="camera-video" autoplay playsinline></video>\r\n        \r\n        \r\n        \r\n        \x3c!-- Processing indicator (hidden by default) --\x3e\r\n        <div id="processing-indicator" class="processing-overlay hidden">\r\n          <div class="processing-content">\r\n            <div class="spinner"></div>\r\n            <p class="processing-text">Processing...</p>\r\n          </div>\r\n        </div>\r\n        \r\n        \x3c!-- Camera error message (hidden by default) --\x3e\r\n        <div id="camera-error" class="error-overlay hidden">\r\n          <div class="error-content">\r\n            <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\r\n              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\r\n            </svg>\r\n            <p class="error-title">Camera access denied or not available</p>\r\n            <p class="error-subtitle">Please allow camera access and try again</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    \x3c!-- Footer with manual entry option --\x3e\r\n    <div class="scanner-footer">\r\n      <p class="manual-entry-text">Or enter details manually</p>\r\n    </div>\r\n  </div>\r\n  \r\n  \x3c!-- Hidden elements for results --\x3e\r\n  <div class="hidden-results">\r\n    <div id="scan-error-message" class="scan-error hidden">\r\n      Unable to process image. Please try again with better lighting and alignment.\r\n    </div>\r\n  </div>\r\n</div>\r\n',"./initial/initial.template.html":'<div class="container">\r\n  <div class="relative w-12 h-12">\r\n    <div\r\n      class="absolute w-full h-full border-4 rounded-full border-transparent border-t-sunflower-yellow animate-spin"\r\n    >\r\n    \r\n  </div>\r\n    <div\r\n      class="absolute w-full h-full border-4 rounded-full border-transparent border-b-navy-blue animate-[spin_1.5s_linear_reverse_infinite]"\r\n    ></div>\r\n  </div>\r\n</div>\r\n'})),this.store=e,this.state=e.getState()}handleDomAccessError(e){this.store.transitionTo(this.state.state)}$(e){const t=document.querySelector(e);return t||this.handleDomAccessError(e),t}$_all(e){const t=document.querySelectorAll(e);return 0===t.length&&this.handleDomAccessError(e),t}buildTemplatePath(){const e=this.constructor.name.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().replace("-component","");return`./${e}/${e}.template.html`}processTemplate(e,t){return e.replace(/\{([^{}]+)\}/g,((e,r)=>r.trim()in t?t[r.trim()]:""))}templateData(){return{}}showError(e,t=5e3){this.notificationWrapper.push("error",e,t)}showWarning(e,t=5e3){this.notificationWrapper.push("warning",e,t)}showMessage(e,t=5e3){this.notificationWrapper.push("message",e,t)}displayLoading(){l.getInstance().show()}hideLoading(){l.getInstance().hide()}render(){try{const t=this.buildTemplatePath();if(t in this.templates)try{const e=this.templates[t];return this.processTemplate(e,this.templateData())}catch(e){this.showError(`Failed to load template: ${t}`),this.store.transitionTo(this.state.state)}else this.showError(`Template not found: ${t}`)}catch(e){this.showError("An error occurred while rendering the component")}return""}preventNonNumericValues(e,t){t.forEach((t=>{const r=e.querySelector(t);r.addEventListener("input",(()=>{r.value=r.value.replace(/\D/g,"")}))}))}attachEvents(){try{this.attachEventsInternal()}catch(e){this.showError("An error occurred while setting up component events")}}attachEventsInternal(){}}class InitialComponent extends BaseComponent{}var c,u,p;(u=c||(c={})).assertEqual=e=>{},u.assertIs=function(e){},u.assertNever=function(e){throw new Error},u.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},u.getValidEnumValues=e=>{const t=u.objectKeys(e).filter((t=>"number"!=typeof e[e[t]])),r={};for(const n of t)r[n]=e[n];return u.objectValues(r)},u.objectValues=e=>u.objectKeys(e).map((function(t){return e[t]})),u.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},u.find=(e,t)=>{for(const r of e)if(t(r))return r},u.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,u.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},u.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(p||(p={})).mergeShapes=(e,t)=>({...e,...t});const h=c.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=e=>{switch(typeof e){case"undefined":return h.undefined;case"string":return h.string;case"number":return Number.isNaN(e)?h.nan:h.number;case"boolean":return h.boolean;case"function":return h.function;case"bigint":return h.bigint;case"symbol":return h.symbol;case"object":return Array.isArray(e)?h.array:null===e?h.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?h.promise:"undefined"!=typeof Map&&e instanceof Map?h.map:"undefined"!=typeof Set&&e instanceof Set?h.set:"undefined"!=typeof Date&&e instanceof Date?h.date:h.object;default:return h.unknown}},m=c.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ZodError extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},r={_errors:[]},processError=e=>{for(const n of e.issues)if("invalid_union"===n.code)n.unionErrors.map(processError);else if("invalid_return_type"===n.code)processError(n.returnTypeError);else if("invalid_arguments"===n.code)processError(n.argumentsError);else if(0===n.path.length)r._errors.push(t(n));else{let e=r,s=0;for(;s<n.path.length;){const r=n.path[s];s===n.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(n))):e[r]=e[r]||{_errors:[]},e=e[r],s++}}};return processError(this),r}static assert(e){if(!(e instanceof ZodError))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,c.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}ZodError.create=e=>new ZodError(e);const errorMap=(e,t)=>{let r;switch(e.code){case m.invalid_type:r=e.received===h.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case m.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,c.jsonStringifyReplacer)}`;break;case m.unrecognized_keys:r=`Unrecognized key(s) in object: ${c.joinValues(e.keys,", ")}`;break;case m.invalid_union:r="Invalid input";break;case m.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${c.joinValues(e.options)}`;break;case m.invalid_enum_value:r=`Invalid enum value. Expected ${c.joinValues(e.options)}, received '${e.received}'`;break;case m.invalid_arguments:r="Invalid function arguments";break;case m.invalid_return_type:r="Invalid function return type";break;case m.invalid_date:r="Invalid date";break;case m.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:c.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case m.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case m.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case m.custom:r="Invalid input";break;case m.invalid_intersection_types:r="Intersection results could not be merged";break;case m.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case m.not_finite:r="Number must be finite";break;default:r=t.defaultError,c.assertNever(e)}return{message:r}};let f=errorMap;function addIssueToContext(e,t){const r=f,n=(e=>{const{data:t,path:r,errorMaps:n,issueData:s}=e,a=[...r,...s.path||[]],i={...s,path:a};if(void 0!==s.message)return{...s,path:a,message:s.message};let o="";const d=n.filter((e=>!!e)).slice().reverse();for(const l of d)o=l(i,{data:t,defaultError:o}).message;return{...s,path:a,message:o}})({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===errorMap?void 0:errorMap].filter((e=>!!e))});e.common.issues.push(n)}class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return v;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const n of t){const e=await n.key,t=await n.value;r.push({key:e,value:t})}return ParseStatus.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:s}=n;if("aborted"===t.status)return v;if("aborted"===s.status)return v;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!n.alwaysSet||(r[t.value]=s.value)}return{status:e.value,value:r}}}const v=Object.freeze({status:"aborted"}),DIRTY=e=>({status:"dirty",value:e}),OK=e=>({status:"valid",value:e}),isAborted=e=>"aborted"===e.status,isDirty=e=>"dirty"===e.status,isValid=e=>"valid"===e.status,isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise;var g,y;(y=g||(g={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},y.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class ParseInputLazyPath{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(e,t)=>{if(isValid(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ZodError(e.common.issues);return this._error=t,this._error}}};function processCreateParams(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:s}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{const{message:a}=e;return"invalid_enum_value"===t.code?{message:a??s.defaultError}:void 0===s.data?{message:a??n??s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:a??r??s.defaultError}},description:s}}class ZodType{get description(){return this._def.description}_getType(e){return getParsedType(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:getParsedType(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(isAsync(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:(null==t?void 0:t.async)??!1,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},n=this._parseSync({data:e,path:r.path,parent:r});return handleResult(r,n)}"~validate"(e){var t,r;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:n});return isValid(t)?{value:t.value}:{issues:n.common.issues}}catch(s){(null==(r=null==(t=null==s?void 0:s.message)?void 0:t.toLowerCase())?void 0:r.includes("encountered"))&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then((e=>isValid(e)?{value:e.value}:{issues:n.common.issues}))}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:getParsedType(e)},n=this._parse({data:e,path:r.path,parent:r}),s=await(isAsync(n)?n:Promise.resolve(n));return handleResult(r,s)}refine(e,t){const getIssueProperties=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,r)=>{const n=e(t),setError=()=>r.addIssue({code:m.custom,...getIssueProperties(t)});return"undefined"!=typeof Promise&&n instanceof Promise?n.then((e=>!!e||(setError(),!1))):!!n||(setError(),!1)}))}refinement(e,t){return this._refinement(((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1)))}_refinement(e){return new ZodEffects({schema:this,typeName:j.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:j.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:t,typeName:j.ZodDefault})}brand(){return new ZodBranded({typeName:j.ZodBranded,type:this,...processCreateParams(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:t,typeName:j.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const b=/^c[^\s-]{8,}$/i,x=/^[0-9a-z]+$/,_=/^[0-9A-HJKMNP-TV-Z]{26}$/i,w=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,C=/^[a-z0-9_-]{21}$/i,I=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,E=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,k=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Z;const T=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,S=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,P=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,N=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,O=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,A=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,L="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",R=new RegExp(`^${L}$`);function timeRegexSource(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function datetimeRegex(e){let t=`${L}T${timeRegexSource(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function isValidJWT(e,t){if(!I.test(e))return!1;try{const[r]=e.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),s=JSON.parse(atob(n));return"object"==typeof s&&null!==s&&((!("typ"in s)||"JWT"===(null==s?void 0:s.typ))&&(!!s.alg&&(!t||s.alg===t)))}catch{return!1}}function isValidCidr(e,t){return!("v4"!==t&&t||!S.test(e))||!("v6"!==t&&t||!N.test(e))}class ZodString extends ZodType{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==h.string){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.string,received:t.parsedType}),v}const t=new ParseStatus;let r;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("max"===a.kind)e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),t.dirty());else if("length"===a.kind){const n=e.data.length>a.value,s=e.data.length<a.value;(n||s)&&(r=this._getOrReturnCtx(e,r),n?addIssueToContext(r,{code:m.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):s&&addIssueToContext(r,{code:m.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),t.dirty())}else if("email"===a.kind)k.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"email",code:m.invalid_string,message:a.message}),t.dirty());else if("emoji"===a.kind)Z||(Z=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Z.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"emoji",code:m.invalid_string,message:a.message}),t.dirty());else if("uuid"===a.kind)w.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"uuid",code:m.invalid_string,message:a.message}),t.dirty());else if("nanoid"===a.kind)C.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"nanoid",code:m.invalid_string,message:a.message}),t.dirty());else if("cuid"===a.kind)b.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cuid",code:m.invalid_string,message:a.message}),t.dirty());else if("cuid2"===a.kind)x.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cuid2",code:m.invalid_string,message:a.message}),t.dirty());else if("ulid"===a.kind)_.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"ulid",code:m.invalid_string,message:a.message}),t.dirty());else if("url"===a.kind)try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"url",code:m.invalid_string,message:a.message}),t.dirty()}else if("regex"===a.kind){a.regex.lastIndex=0;a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"regex",code:m.invalid_string,message:a.message}),t.dirty())}else if("trim"===a.kind)e.data=e.data.trim();else if("includes"===a.kind)e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),t.dirty());else if("toLowerCase"===a.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===a.kind)e.data=e.data.toUpperCase();else if("startsWith"===a.kind)e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:{startsWith:a.value},message:a.message}),t.dirty());else if("endsWith"===a.kind)e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:{endsWith:a.value},message:a.message}),t.dirty());else if("datetime"===a.kind){datetimeRegex(a).test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:"datetime",message:a.message}),t.dirty())}else if("date"===a.kind){R.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:"date",message:a.message}),t.dirty())}else if("time"===a.kind){new RegExp(`^${timeRegexSource(a)}$`).test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.invalid_string,validation:"time",message:a.message}),t.dirty())}else"duration"===a.kind?E.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"duration",code:m.invalid_string,message:a.message}),t.dirty()):"ip"===a.kind?(n=e.data,("v4"!==(s=a.version)&&s||!T.test(n))&&("v6"!==s&&s||!P.test(n))&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"ip",code:m.invalid_string,message:a.message}),t.dirty())):"jwt"===a.kind?isValidJWT(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"jwt",code:m.invalid_string,message:a.message}),t.dirty()):"cidr"===a.kind?isValidCidr(e.data,a.version)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"cidr",code:m.invalid_string,message:a.message}),t.dirty()):"base64"===a.kind?O.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"base64",code:m.invalid_string,message:a.message}),t.dirty()):"base64url"===a.kind?A.test(e.data)||(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{validation:"base64url",code:m.invalid_string,message:a.message}),t.dirty()):c.assertNever(a);var n,s;return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement((t=>e.test(t)),{validation:t,code:m.invalid_string,...g.errToObj(r)})}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...g.errToObj(e)})}url(e){return this._addCheck({kind:"url",...g.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...g.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...g.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...g.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...g.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...g.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...g.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...g.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...g.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...g.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...g.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...g.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:(null==e?void 0:e.offset)??!1,local:(null==e?void 0:e.local)??!1,...g.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...g.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...g.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...g.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...g.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...g.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...g.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...g.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...g.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...g.errToObj(t)})}nonempty(e){return this.min(1,g.errToObj(e))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function floatSafeRemainder(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}ZodString.create=e=>new ZodString({checks:[],typeName:j.ZodString,coerce:(null==e?void 0:e.coerce)??!1,...processCreateParams(e)});class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==h.number){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.number,received:t.parsedType}),v}let t;const r=new ParseStatus;for(const n of this._def.checks)if("int"===n.kind)c.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty());else if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty())}else"multipleOf"===n.kind?0!==floatSafeRemainder(e.data,n.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_finite,message:n.message}),r.dirty()):c.assertNever(n);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,r,n){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:g.toString(n)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:g.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:g.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:g.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:g.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&c.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ZodNumber.create=e=>new ZodNumber({checks:[],typeName:j.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==h.bigint)return this._getInvalidInput(e);let t;const r=new ParseStatus;for(const n of this._def.checks)if("min"===n.kind){(n.inclusive?e.data<n.value:e.data<=n.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else if("max"===n.kind){(n.inclusive?e.data>n.value:e.data>=n.value)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty())}else"multipleOf"===n.kind?e.data%n.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),addIssueToContext(t,{code:m.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):c.assertNever(n);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.bigint,received:t.parsedType}),v}gte(e,t){return this.setLimit("min",e,!0,g.toString(t))}gt(e,t){return this.setLimit("min",e,!1,g.toString(t))}lte(e,t){return this.setLimit("max",e,!0,g.toString(t))}lt(e,t){return this.setLimit("max",e,!1,g.toString(t))}setLimit(e,t,r,n){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:g.toString(n)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:g.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:g.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:g.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:g.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:g.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}ZodBigInt.create=e=>new ZodBigInt({checks:[],typeName:j.ZodBigInt,coerce:(null==e?void 0:e.coerce)??!1,...processCreateParams(e)});class ZodBoolean extends ZodType{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==h.boolean){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.boolean,received:t.parsedType}),v}return OK(e.data)}}ZodBoolean.create=e=>new ZodBoolean({typeName:j.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...processCreateParams(e)});class ZodDate extends ZodType{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==h.date){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.date,received:t.parsedType}),v}if(Number.isNaN(e.data.getTime())){return addIssueToContext(this._getOrReturnCtx(e),{code:m.invalid_date}),v}const t=new ParseStatus;let r;for(const n of this._def.checks)"min"===n.kind?e.data.getTime()<n.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),t.dirty()):"max"===n.kind?e.data.getTime()>n.value&&(r=this._getOrReturnCtx(e,r),addIssueToContext(r,{code:m.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),t.dirty()):c.assertNever(n);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:g.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:g.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}ZodDate.create=e=>new ZodDate({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:j.ZodDate,...processCreateParams(e)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==h.symbol){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.symbol,received:t.parsedType}),v}return OK(e.data)}}ZodSymbol.create=e=>new ZodSymbol({typeName:j.ZodSymbol,...processCreateParams(e)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.undefined,received:t.parsedType}),v}return OK(e.data)}}ZodUndefined.create=e=>new ZodUndefined({typeName:j.ZodUndefined,...processCreateParams(e)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==h.null){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.null,received:t.parsedType}),v}return OK(e.data)}}ZodNull.create=e=>new ZodNull({typeName:j.ZodNull,...processCreateParams(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return OK(e.data)}}ZodAny.create=e=>new ZodAny({typeName:j.ZodAny,...processCreateParams(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return OK(e.data)}}ZodUnknown.create=e=>new ZodUnknown({typeName:j.ZodUnknown,...processCreateParams(e)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.never,received:t.parsedType}),v}}ZodNever.create=e=>new ZodNever({typeName:j.ZodNever,...processCreateParams(e)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==h.undefined){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.void,received:t.parsedType}),v}return OK(e.data)}}ZodVoid.create=e=>new ZodVoid({typeName:j.ZodVoid,...processCreateParams(e)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==h.array)return addIssueToContext(t,{code:m.invalid_type,expected:h.array,received:t.parsedType}),v;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,s=t.data.length<n.exactLength.value;(e||s)&&(addIssueToContext(t,{code:e?m.too_big:m.too_small,minimum:s?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(addIssueToContext(t,{code:m.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(addIssueToContext(t,{code:m.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map(((e,r)=>n.type._parseAsync(new ParseInputLazyPath(t,e,t.path,r))))).then((e=>ParseStatus.mergeArray(r,e)));const s=[...t.data].map(((e,r)=>n.type._parseSync(new ParseInputLazyPath(t,e,t.path,r))));return ParseStatus.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:g.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:g.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:g.toString(t)}})}nonempty(e){return this.min(1,e)}}function deepPartialify(e){if(e instanceof ZodObject){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=ZodOptional.create(deepPartialify(n))}return new ZodObject({...e._def,shape:()=>t})}return e instanceof ZodArray?new ZodArray({...e._def,type:deepPartialify(e.element)}):e instanceof ZodOptional?ZodOptional.create(deepPartialify(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(deepPartialify(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map((e=>deepPartialify(e)))):e}ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:j.ZodArray,...processCreateParams(t)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=c.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==h.object){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.object,received:t.parsedType}),v}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:s}=this._getCached(),a=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const o in r.data)s.includes(o)||a.push(o);const i=[];for(const o of s){const e=n[o],t=r.data[o];i.push({key:{status:"valid",value:o},value:e._parse(new ParseInputLazyPath(r,t,r.path,o)),alwaysSet:o in r.data})}if(this._def.catchall instanceof ZodNever){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of a)i.push({key:{status:"valid",value:t},value:{status:"valid",value:r.data[t]}});else if("strict"===e)a.length>0&&(addIssueToContext(r,{code:m.unrecognized_keys,keys:a}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of a){const n=r.data[t];i.push({key:{status:"valid",value:t},value:e._parse(new ParseInputLazyPath(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of i){const r=await t.key,n=await t.value;e.push({key:r,value:n,alwaysSet:t.alwaysSet})}return e})).then((e=>ParseStatus.mergeObjectSync(t,e))):ParseStatus.mergeObjectSync(t,i)}get shape(){return this._def.shape()}strict(e){return g.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,s;const a=(null==(s=(n=this._def).errorMap)?void 0:s.call(n,t,r).message)??r.defaultError;return"unrecognized_keys"===t.code?{message:g.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:j.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};for(const r of c.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};for(const r of c.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new ZodObject({...this._def,shape:()=>t})}deepPartial(){return deepPartialify(this)}partial(e){const t={};for(const r of c.objectKeys(this.shape)){const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}return new ZodObject({...this._def,shape:()=>t})}required(e){const t={};for(const r of c.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof ZodOptional;)e=e._def.innerType;t[r]=e}return new ZodObject({...this._def,shape:()=>t})}keyof(){return createZodEnum(c.objectKeys(this.shape))}}ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:j.ZodObject,...processCreateParams(t)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map((async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const r=e.map((e=>new ZodError(e.ctx.common.issues)));return addIssueToContext(t,{code:m.invalid_union,unionErrors:r}),v}));{let e;const n=[];for(const a of r){const r={...t,common:{...t.common,issues:[]},parent:null},s=a._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=n.map((e=>new ZodError(e)));return addIssueToContext(t,{code:m.invalid_union,unionErrors:s}),v}}get options(){return this._def.options}}function mergeValues(e,t){const r=getParsedType(e),n=getParsedType(t);if(e===t)return{valid:!0,data:e};if(r===h.object&&n===h.object){const r=c.objectKeys(t),n=c.objectKeys(e).filter((e=>-1!==r.indexOf(e))),s={...e,...t};for(const a of n){const r=mergeValues(e[a],t[a]);if(!r.valid)return{valid:!1};s[a]=r.data}return{valid:!0,data:s}}if(r===h.array&&n===h.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const s=mergeValues(e[n],t[n]);if(!s.valid)return{valid:!1};r.push(s.data)}return{valid:!0,data:r}}return r===h.date&&n===h.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:j.ZodUnion,...processCreateParams(t)});class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),handleParsed=(e,n)=>{if(isAborted(e)||isAborted(n))return v;const s=mergeValues(e.value,n.value);return s.valid?((isDirty(e)||isDirty(n))&&t.dirty(),{status:t.value,value:s.data}):(addIssueToContext(r,{code:m.invalid_intersection_types}),v)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([e,t])=>handleParsed(e,t))):handleParsed(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ZodIntersection.create=(e,t,r)=>new ZodIntersection({left:e,right:t,typeName:j.ZodIntersection,...processCreateParams(r)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.array)return addIssueToContext(r,{code:m.invalid_type,expected:h.array,received:r.parsedType}),v;if(r.data.length<this._def.items.length)return addIssueToContext(r,{code:m.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),v;!this._def.rest&&r.data.length>this._def.items.length&&(addIssueToContext(r,{code:m.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map(((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new ParseInputLazyPath(r,e,r.path,t)):null})).filter((e=>!!e));return r.common.async?Promise.all(n).then((e=>ParseStatus.mergeArray(t,e))):ParseStatus.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:j.ZodTuple,rest:null,...processCreateParams(t)})};class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.map)return addIssueToContext(r,{code:m.invalid_type,expected:h.map,received:r.parsedType}),v;const n=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map((([e,t],a)=>({key:n._parse(new ParseInputLazyPath(r,e,r.path,[a,"key"])),value:s._parse(new ParseInputLazyPath(r,t,r.path,[a,"value"]))})));if(r.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const r of a){const n=await r.key,s=await r.value;if("aborted"===n.status||"aborted"===s.status)return v;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const r of a){const n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return v;"dirty"!==n.status&&"dirty"!==s.status||t.dirty(),e.set(n.value,s.value)}return{status:t.value,value:e}}}}ZodMap.create=(e,t,r)=>new ZodMap({valueType:t,keyType:e,typeName:j.ZodMap,...processCreateParams(r)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==h.set)return addIssueToContext(r,{code:m.invalid_type,expected:h.set,received:r.parsedType}),v;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(addIssueToContext(r,{code:m.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(addIssueToContext(r,{code:m.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const s=this._def.valueType;function finalizeSet(e){const r=new Set;for(const n of e){if("aborted"===n.status)return v;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const a=[...r.data.values()].map(((e,t)=>s._parse(new ParseInputLazyPath(r,e,r.path,t))));return r.common.async?Promise.all(a).then((e=>finalizeSet(e))):finalizeSet(a)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:g.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:g.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:j.ZodSet,...processCreateParams(t)});class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:j.ZodLazy,...processCreateParams(t)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{received:t.data,code:m.invalid_literal,expected:this._def.value}),v}return{status:"valid",value:e.data}}get value(){return this._def.value}}function createZodEnum(e,t){return new ZodEnum({values:e,typeName:j.ZodEnum,...processCreateParams(t)})}ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:j.ZodLiteral,...processCreateParams(t)});class ZodEnum extends ZodType{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return addIssueToContext(t,{expected:c.joinValues(r),received:t.parsedType,code:m.invalid_type}),v}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return addIssueToContext(t,{received:t.data,code:m.invalid_enum_value,options:r}),v}return OK(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ZodEnum.create(e,{...this._def,...t})}exclude(e,t=this._def){return ZodEnum.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{_parse(e){const t=c.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==h.string&&r.parsedType!==h.number){const e=c.objectValues(t);return addIssueToContext(r,{expected:c.joinValues(e),received:r.parsedType,code:m.invalid_type}),v}if(this._cache||(this._cache=new Set(c.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=c.objectValues(t);return addIssueToContext(r,{received:r.data,code:m.invalid_enum_value,options:e}),v}return OK(e.data)}get enum(){return this._def.values}}ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:j.ZodNativeEnum,...processCreateParams(t)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==h.promise&&!1===t.common.async)return addIssueToContext(t,{code:m.invalid_type,expected:h.promise,received:t.parsedType}),v;const r=t.parsedType===h.promise?t.data:Promise.resolve(t.data);return OK(r.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:j.ZodPromise,...processCreateParams(t)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===j.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:e=>{addIssueToContext(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){const e=n.transform(r.data,s);if(r.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return v;const n=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===n.status?v:"dirty"===n.status||"dirty"===t.value?DIRTY(n.value):n}));{if("aborted"===t.value)return v;const n=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===n.status?v:"dirty"===n.status||"dirty"===t.value?DIRTY(n.value):n}}if("refinement"===n.type){const executeRefinement=e=>{const t=n.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?v:("dirty"===e.status&&t.dirty(),executeRefinement(e.value),{status:t.value,value:e.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>"aborted"===e.status?v:("dirty"===e.status&&t.dirty(),executeRefinement(e.value).then((()=>({status:t.value,value:e.value}))))))}if("transform"===n.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!isValid(e))return v;const a=n.transform(e.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((e=>isValid(e)?Promise.resolve(n.transform(e.value,s)).then((e=>({status:t.value,value:e}))):v))}c.assertNever(n)}}ZodEffects.create=(e,t,r)=>new ZodEffects({schema:e,typeName:j.ZodEffects,effect:t,...processCreateParams(r)}),ZodEffects.createWithPreprocess=(e,t,r)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:j.ZodEffects,...processCreateParams(r)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===h.undefined?OK(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:j.ZodOptional,...processCreateParams(t)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===h.null?OK(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:j.ZodNullable,...processCreateParams(t)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===h.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:j.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...processCreateParams(t)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return isAsync(n)?n.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new ZodError(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new ZodError(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:j.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...processCreateParams(t)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==h.nan){const t=this._getOrReturnCtx(e);return addIssueToContext(t,{code:m.invalid_type,expected:h.nan,received:t.parsedType}),v}return{status:"valid",value:e.data}}}ZodNaN.create=e=>new ZodNaN({typeName:j.ZodNaN,...processCreateParams(e)});class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?v:"dirty"===e.status?(t.dirty(),DIRTY(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})()}{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?v:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:j.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(e){const t=this._def.innerType._parse(e),freeze=e=>(isValid(e)&&(e.value=Object.freeze(e.value)),e);return isAsync(t)?t.then((e=>freeze(e))):freeze(t)}unwrap(){return this._def.innerType}}var j,$;ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:j.ZodReadonly,...processCreateParams(t)}),($=j||(j={})).ZodString="ZodString",$.ZodNumber="ZodNumber",$.ZodNaN="ZodNaN",$.ZodBigInt="ZodBigInt",$.ZodBoolean="ZodBoolean",$.ZodDate="ZodDate",$.ZodSymbol="ZodSymbol",$.ZodUndefined="ZodUndefined",$.ZodNull="ZodNull",$.ZodAny="ZodAny",$.ZodUnknown="ZodUnknown",$.ZodNever="ZodNever",$.ZodVoid="ZodVoid",$.ZodArray="ZodArray",$.ZodObject="ZodObject",$.ZodUnion="ZodUnion",$.ZodDiscriminatedUnion="ZodDiscriminatedUnion",$.ZodIntersection="ZodIntersection",$.ZodTuple="ZodTuple",$.ZodRecord="ZodRecord",$.ZodMap="ZodMap",$.ZodSet="ZodSet",$.ZodFunction="ZodFunction",$.ZodLazy="ZodLazy",$.ZodLiteral="ZodLiteral",$.ZodEnum="ZodEnum",$.ZodEffects="ZodEffects",$.ZodNativeEnum="ZodNativeEnum",$.ZodOptional="ZodOptional",$.ZodNullable="ZodNullable",$.ZodDefault="ZodDefault",$.ZodCatch="ZodCatch",$.ZodPromise="ZodPromise",$.ZodBranded="ZodBranded",$.ZodPipeline="ZodPipeline",$.ZodReadonly="ZodReadonly";const M=ZodString.create,D=ZodNumber.create;ZodNever.create,ZodArray.create;const F=ZodObject.create;ZodUnion.create,ZodIntersection.create,ZodTuple.create,ZodEnum.create,ZodPromise.create,ZodOptional.create,ZodNullable.create;const z=/^(0[1-9]|1[0-2])\/([0-9]{2})$/,B=F({creditCard:F({cardNumber:M().min(13,{message:"Card number must be at least 13 digits"}).max(19,{message:"Card number must be at most 19 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Card number must contain only digits"}),exp:M().min(1,{message:"Expiration date is required"}).regex(z,{message:"Expiration date must be in the format MM/YY (e.g., 12/23)"}).refine((e=>{if(!z.test(e))return!0;const[t,r]=e.split("/"),n=parseInt(t,10),s=parseInt("20"+r,10),a=new Date,i=a.getFullYear(),o=a.getMonth()+1;return!(s<i)&&!(s===i&&n<o)}),{message:"Card has expired. Please enter a valid expiration date."}),zipCode:M().length(5,{message:"ZIP code must be a 5-digit number"}).refine((e=>/^\d+$/.test(e)),{message:"ZIP code must contain only digits"}),cvv:M().min(3,{message:"CVV must be at least 3 digits"}).max(4,{message:"CVV must be at most 4 digits"}).refine((e=>/^\d+$/.test(e)),{message:"CVV must contain only digits"})}),phone:M().length(10,{message:"Phone number must be a numeric value with 10 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Phone number must contain only digits"})});function validate(e,t){const r=e.safeParse(t),n={};if(!r.success)for(const s of r.error.issues){const e=s.path.join(".");n[e]||(n[e]=[]),n[e].push(s.message)}return n}class PageBaseComponent extends BaseComponent{constructor(e){super(e),this.templates=Object.assign({"./extended-register-form/extended-register-form.template.html":'<section class="container">\r\n    <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\r\n      <div class="mx-auto max-w-5xl">\r\n        <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\r\n          <form class="form bordered-form" aria-labelledby="credit-card-form">\r\n            <h2 id="credit-card-form" class="sr-only">Register to authorize pump</h2>\r\n\r\n            \x3c!-- New Fields --\x3e\r\n            <div class="mb-6 grid grid-cols-2 gap-4">\r\n              \x3c!-- First Name --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label for="first-name" class="mb-2 block text-sm font-medium">First Name*</label>\r\n                <input\r\n                  type="text"\r\n                  id="first-name"\r\n                  class="form-input"\r\n                  placeholder="John"\r\n                  aria-required="true"\r\n                />\r\n              </div>\r\n\r\n              \x3c!-- Last Name --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label for="last-name" class="mb-2 block text-sm font-medium">Last Name*</label>\r\n                <input\r\n                  type="text"\r\n                  id="last-name"\r\n                  class="form-input"\r\n                  placeholder="Doe"\r\n                  aria-required="true"\r\n                />\r\n              </div>\r\n\r\n              \x3c!-- Email --\x3e\r\n              <div class="col-span-2">\r\n                <label for="email" class="mb-2 block text-sm font-medium">Email*</label>\r\n                <input\r\n                  type="email"\r\n                  id="email"\r\n                  class="form-input"\r\n                  placeholder="example@example.com"\r\n                  aria-required="true"\r\n                />\r\n              </div>\r\n\r\n              \x3c!-- Password --\x3e\r\n              <div class="col-span-2">\r\n                \r\n                <label for="password" class="mb-2 block text-sm font-medium" id="password-label">Password*</label>\r\n                <p class="mb-4 text-sm text-gray-600" id="password-description">\r\n                  \r\n                </p>\r\n                <div class="relative">\r\n                  <input\r\n                    type="password"\r\n                    id="password"\r\n                    class="form-input"\r\n                    placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"\r\n                    aria-required="true"\r\n                  />\r\n                  <button\r\n                    type="button"\r\n                    id="reset-password-button"\r\n                    class="absolute right-2 top-1/2 -translate-y-1/2 text-sm text-navy-blue hover:text-navy-blue-dark cursor-pointer"\r\n                    aria-label="Reset password"\r\n                  >\r\n                    Reset Password\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              \x3c!-- Pin Code --\x3e\r\n              <div class="col-span-2">\r\n                <label for="pin-code" class="mb-2 block text-sm font-medium">Pin Code*</label>\r\n                <input\r\n                  type="password"\r\n                  id="pin-code"\r\n                  class="form-input"\r\n                  maxlength="4"\r\n                  placeholder="1234"\r\n                  aria-required="true"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n\r\n            <div class="mb-6 grid grid-cols-1 gap-4">\r\n              \x3c!-- Mobile Phone Input --\x3e\r\n              <div class="col-span-1">\r\n                <label\r\n                  for="mobile-phone-input"\r\n                  class="mb-2 block text-sm font-medium"\r\n                  >Mobile Phone*</label\r\n                >\r\n                <input\r\n                  type="tel"\r\n                  id="mobile-phone-input"\r\n                  class="form-input"\r\n                  inputmode="tel"\r\n                  placeholder="(123) 456-7890"\r\n                  aria-required="true"\r\n                  aria-describedby="mobile-phone-description"\r\n                />\r\n                <span id="mobile-phone-description" class="sr-only">\r\n                  Enter your 10-digit mobile phone number.\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            \r\n          <div class="mb-6 grid grid-cols-1 gap-4">\r\n            \x3c!-- Pump Number Dropdown --\x3e\r\n            <div class="col-span-1">\r\n              <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\r\n                Pump Number*\r\n              </label>\r\n              <select\r\n                id="pump-number"\r\n                class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\r\n                aria-required="true"\r\n                aria-describedby="pump-number-description"\r\n              >\r\n                \x3c!-- Options will be dynamically populated --\x3e\r\n              </select>\r\n              <span id="pump-number-description" class="sr-only">\r\n                Select the pump number you want to authorize.\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n            <div class="mb-6 grid grid-cols-2 gap-4">\r\n              \x3c!-- Card Number Input --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label\r\n                  for="card-number-input"\r\n                  class="mb-2 block text-sm font-medium"\r\n                  >Card number*</label\r\n                >\r\n                <div class="relative flex items-center">\r\n                  <input\r\n                    type="text"\r\n                    class="form-input w-full"\r\n                    aria-required="true"\r\n                    inputmode="numeric"\r\n                    id="card-number-input"\r\n                    placeholder="xxxx-xxxx-xxxx-xxxx"\r\n                    aria-describedby="card-number-description"\r\n                  />\r\n                  <button\r\n                    type="button"\r\n                    id="scan-card-btn"\r\n                    class="absolute right-2 p-1 text-gray-500 hover:text-navy-blue"\r\n                    aria-label="Scan credit card with camera"\r\n                  >\r\n                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\r\n                      <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4z" clip-rule="evenodd" />\r\n                      <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />\r\n                    </svg>\r\n                  </button>\r\n                </div>\r\n                <span id="card-number-description" class="sr-only">\r\n                  Enter your 16-digit card number without spaces or dashes.\r\n                </span>\r\n              </div>\r\n              \x3c!-- Zipcode Input --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label for="zipcode" class="mb-2 block text-sm font-medium"\r\n                  >Zipcode*</label\r\n                >\r\n                <input\r\n                  type="text"\r\n                  id="zipcode"\r\n                  maxlength="5"\r\n                  class="form-input"\r\n                  inputmode="numeric"\r\n                  placeholder="12345"\r\n                  aria-required="true"\r\n                  aria-describedby="zipcode-description"\r\n                />\r\n                <span id="zipcode-description" class="sr-only">\r\n                  Enter a 5-digit ZIP code.\r\n                </span>\r\n              </div>\r\n\r\n              \x3c!-- Card Expiration Input --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label\r\n                  for="card-expiration-input"\r\n                  class="mb-2 block text-sm font-medium"\r\n                  >Card expiration*</label\r\n                >\r\n                <div class="relative">\r\n                  <input\r\n                    type="text"\r\n                    class="form-input"\r\n                    placeholder="MM/YY"\r\n                    inputmode="numeric"\r\n                    aria-required="true"\r\n                    id="card-expiration-input"\r\n                    aria-describedby="card-expiration-description"\r\n                  />\r\n                  <span id="card-expiration-description" class="sr-only">\r\n                    Enter the expiration date in MM/YY format.\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              \x3c!-- CVV Input with Tooltip --\x3e\r\n              <div class="col-span-2 sm:col-span-1">\r\n                <label for="cvv-input" class="mb-2 block text-sm font-medium">\r\n                  CVV*\r\n                  <button\r\n                    type="button"\r\n                    class="relative group"\r\n                    aria-label="CVV information"\r\n                  >\r\n                    <svg\r\n                      aria-hidden="true"\r\n                      fill="currentColor"\r\n                      viewBox="0 0 24 24"\r\n                      xmlns="http://www.w3.org/2000/svg"\r\n                      class="h-4 w-4 text-gray-400 hover:text-navy-blue"\r\n                    >\r\n                      <path\r\n                        fill-rule="evenodd"\r\n                        clip-rule="evenodd"\r\n                        d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.408-5.5a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2h-.01ZM10 10a1 1 0 1 0 0 2h1v3h-1a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2h-1v-4a1 1 0 0 0-1-1h-2Z"\r\n                      />\r\n                    </svg>\r\n                    <span\r\n                      role="tooltip"\r\n                      aria-hidden="true"\r\n                      class="absolute left-1/2 top-full mt-1 hidden w-max -translate-x-1/2 rounded-lg bg-navy-blue px-3 py-2 text-sm font-medium text-white shadow-md group-hover:block"\r\n                    >\r\n                      The last 3-4 digits on the back of the card\r\n                    </span>\r\n                  </button>\r\n                </label>\r\n                <input\r\n                  type="text"\r\n                  id="cvv-input"\r\n                  maxlength="4"\r\n                  placeholder="â€¢â€¢â€¢"\r\n                  class="form-input"\r\n                  inputmode="numeric"\r\n                  aria-required="true"\r\n                  aria-describedby="cvv-description"\r\n                />\r\n                <span id="cvv-description" class="sr-only">\r\n                  Enter the 3-digit security code found on the back of your card.\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            \x3c!-- Submit Button --\x3e\r\n            <button\r\n              type="submit"\r\n              aria-label="Register"\r\n              class="btn btn-primary w-full"\r\n            >\r\n              Submit\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <span id="error" class="error" role="alert"></span>\r\n  </section>\r\n\r\n  <div id="cardReaderModalContainer"></div>',"./final/final.template.html":'<div class="container">\r\n  <div class="col-container">\r\n    <img\r\n      role="img"\r\n      class="w-full h-64 md:h-80 object-cover rounded-lg"\r\n      src="pump.svg"\r\n      alt="Illustration of a gas pump"\r\n      aria-describedby="pump-instructions"\r\n    />\r\n\r\n    <h1 id="pump-instructions" class="heading">\r\n      Pump authorized successfully \r\n    </h1>\r\n  </div>\r\n</div>\r\n',"./login-form/login-form.template.html":'<section class="container">\r\n    <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\r\n      <div class="mx-auto max-w-5xl">\r\n        <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\r\n          <form class="form bordered-form" aria-labelledby="credit-card-form">\r\n            <h2 id="credit-card-form" class="sr-only">Login and authorize pump</h2>\r\n  \r\n            <div class="mb-6 grid grid-cols-1 gap-4">\r\n              \x3c!-- Mobile Phone Input --\x3e\r\n              <div class="col-span-1">\r\n                <label\r\n                  for="mobile-phone-input"\r\n                  class="mb-2 block text-sm font-medium"\r\n                  >Mobile Phone*</label\r\n                >\r\n                <input\r\n                  type="tel"\r\n                  id="mobile-phone-input"\r\n                  class="form-input"\r\n                  inputmode="tel"\r\n                  placeholder="(123) 456-7890"\r\n                  aria-required="true"\r\n                  aria-describedby="mobile-phone-description"\r\n                />\r\n                <span id="mobile-phone-description" class="sr-only">\r\n                  Enter your 10-digit mobile phone number.\r\n                </span>\r\n              </div>\r\n            </div>\r\n  \r\n            <div class="mb-6 grid grid-cols-1 gap-4">\r\n              \x3c!-- Pump Number Dropdown --\x3e\r\n              <div class="col-span-1">\r\n                <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\r\n                  Pump Number*\r\n                </label>\r\n                <select\r\n                  id="pump-number"\r\n                  class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\r\n                  aria-required="true"\r\n                  aria-describedby="pump-number-description"\r\n                >\r\n                  \x3c!-- Options will be dynamically populated --\x3e\r\n                </select>\r\n                <span id="pump-number-description" class="sr-only">\r\n                  Select the pump number you want to authorize.\r\n                </span>\r\n              </div>\r\n            </div>\r\n  \r\n            \x3c!-- Submit Button --\x3e\r\n            <button\r\n              type="submit"\r\n              aria-label="Register"\r\n              class="btn btn-primary w-full"\r\n            >\r\n              Submit\r\n            </button>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  \r\n    <span id="error" class="error" role="alert"></span>\r\n  </section>',"./otp-form/otp-form.template.html":'<div class="container">\r\n  <div\r\n    class="form col-container border border-gray-200 shadow-sm justify-between"\r\n  >\r\n    <div class="col-container">\r\n      <div class="font-semibold text-3xl">\r\n        <p>Phone Verification</p>\r\n      </div>\r\n      <div class="flex flex-row text-sm font-medium text-gray-400">\r\n        <p>We have sent a code to your phone number</p>\r\n      </div>\r\n    </div>\r\n\r\n    <form class="form">\r\n      <div\r\n        class="flex flex-row items-center justify-between mx-auto w-full gap-1 my-5"\r\n      >\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n        <div class="w-16 h-16">\r\n          <input\r\n            name="otp"\r\n            class="input-no-spinner w-full h-full flex flex-col items-center justify-center text-center md:px-5 outline-none rounded-xl border border-sunflower-yellow text-lg bg-white focus:bg-gray-50 focus:ring-1 focus:border-navy-blue ring-navy-blue"\r\n            type="number"\r\n            min="0"\r\n            max="9"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <button class="btn btn-primary w-full">Verify</button>\r\n    </form>\r\n    <span id="error" class="error mx-auto" role="alert"></span>\r\n  </div>\r\n</div>\r\n',"./register-form/register-form.template.html":'<section class="container">\r\n  <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\r\n    <div class="mx-auto max-w-5xl">\r\n      <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\r\n        <form class="form bordered-form" aria-labelledby="credit-card-form">\r\n          <h2 id="credit-card-form" class="sr-only">Register to authorize pump</h2>\r\n\r\n          <div class="mb-6 grid grid-cols-1 gap-4">\r\n            \x3c!-- Mobile Phone Input --\x3e\r\n            <div class="col-span-1">\r\n              <label\r\n                for="mobile-phone-input"\r\n                class="mb-2 block text-sm font-medium"\r\n                >Mobile Phone*</label\r\n              >\r\n              <input\r\n                type="tel"\r\n                id="mobile-phone-input"\r\n                class="form-input"\r\n                inputmode="tel"\r\n                placeholder="(123) 456-7890"\r\n                aria-required="true"\r\n                aria-describedby="mobile-phone-description"\r\n              />\r\n              <span id="mobile-phone-description" class="sr-only">\r\n                Enter your 10-digit mobile phone number.\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="mb-6 grid grid-cols-1 gap-4">\r\n            \x3c!-- Pump Number Dropdown --\x3e\r\n            <div class="col-span-1">\r\n              <label for="pump-number" class="mb-2 block text-sm font-medium text-gray-700">\r\n                Pump Number*\r\n              </label>\r\n              <select\r\n                id="pump-number"\r\n                class="form-select w-full rounded-md border border-gray-300 bg-white py-2 px-3 text-sm text-gray-700 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-300 focus:ring-opacity-50 hover:border-gray-400"\r\n                aria-required="true"\r\n                aria-describedby="pump-number-description"\r\n              >\r\n                \x3c!-- Options will be dynamically populated --\x3e\r\n              </select>\r\n              <span id="pump-number-description" class="sr-only">\r\n                Select the pump number you want to authorize.\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class="mb-6 grid grid-cols-2 gap-4">\r\n            \x3c!-- Card Number Input --\x3e\r\n            <div class="col-span-2 sm:col-span-1">\r\n              <label\r\n                for="card-number-input"\r\n                class="mb-2 block text-sm font-medium"\r\n                >Card number*</label\r\n              >\r\n              <div class="relative flex items-center">\r\n                <input\r\n                  type="text"\r\n                  class="form-input w-full"\r\n                  aria-required="true"\r\n                  inputmode="numeric"\r\n                  id="card-number-input"\r\n                  placeholder="xxxx-xxxx-xxxx-xxxx"\r\n                  aria-describedby="card-number-description"\r\n                />\r\n                <button\r\n                  type="button"\r\n                  id="scan-card-btn"\r\n                  class="absolute right-2 p-1 text-gray-500 hover:text-navy-blue"\r\n                  aria-label="Scan credit card with camera"\r\n                >\r\n                  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\r\n                    <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4z" clip-rule="evenodd" />\r\n                    <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n              <span id="card-number-description" class="sr-only">\r\n                Enter your 16-digit card number without spaces or dashes.\r\n              </span>\r\n            </div>\r\n\r\n            \x3c!-- Zipcode Input --\x3e\r\n            <div class="col-span-2 sm:col-span-1">\r\n              <label for="zipcode" class="mb-2 block text-sm font-medium"\r\n                >Zipcode*</label\r\n              >\r\n              <input\r\n                type="text"\r\n                id="zipcode"\r\n                maxlength="5"\r\n                class="form-input"\r\n                inputmode="numeric"\r\n                placeholder="12345"\r\n                aria-required="true"\r\n                aria-describedby="zipcode-description"\r\n              />\r\n              <span id="zipcode-description" class="sr-only">\r\n                Enter a 5-digit ZIP code.\r\n              </span>\r\n            </div>\r\n\r\n            \x3c!-- Card Expiration Input --\x3e\r\n            <div class="col-span-2 sm:col-span-1">\r\n              <label\r\n                for="card-expiration-input"\r\n                class="mb-2 block text-sm font-medium"\r\n                >Card expiration*</label\r\n              >\r\n              <div class="relative">\r\n                <input\r\n                  type="text"\r\n                  class="form-input"\r\n                  placeholder="MM/YY"\r\n                  inputmode="numeric"\r\n                  aria-required="true"\r\n                  id="card-expiration-input"\r\n                  aria-describedby="card-expiration-description"\r\n                />\r\n                <span id="card-expiration-description" class="sr-only">\r\n                  Enter the expiration date in MM/YY format.\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            \x3c!-- CVV Input with Tooltip --\x3e\r\n            <div class="col-span-2 sm:col-span-1">\r\n              <label for="cvv-input" class="mb-2 block text-sm font-medium">\r\n                CVV*\r\n                <button\r\n                  type="button"\r\n                  class="relative group"\r\n                  aria-label="CVV information"\r\n                >\r\n                  <svg\r\n                    aria-hidden="true"\r\n                    fill="currentColor"\r\n                    viewBox="0 0 24 24"\r\n                    xmlns="http://www.w3.org/2000/svg"\r\n                    class="h-4 w-4 text-gray-400 hover:text-navy-blue"\r\n                  >\r\n                    <path\r\n                      fill-rule="evenodd"\r\n                      clip-rule="evenodd"\r\n                      d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.408-5.5a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2h-.01ZM10 10a1 1 0 1 0 0 2h1v3h-1a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2h-1v-4a1 1 0 0 0-1-1h-2Z"\r\n                    />\r\n                  </svg>\r\n                  <span\r\n                    role="tooltip"\r\n                    aria-hidden="true"\r\n                    class="absolute left-1/2 top-full mt-1 hidden w-max -translate-x-1/2 rounded-lg bg-navy-blue px-3 py-2 text-sm font-medium text-white shadow-md group-hover:block"\r\n                  >\r\n                    The last 3-4 digits on the back of the card\r\n                  </span>\r\n                </button>\r\n              </label>\r\n              <input\r\n                type="text"\r\n                id="cvv-input"\r\n                maxlength="4"\r\n                placeholder="â€¢â€¢â€¢"\r\n                class="form-input"\r\n                inputmode="numeric"\r\n                aria-required="true"\r\n                aria-describedby="cvv-description"\r\n              />\r\n              <span id="cvv-description" class="sr-only">\r\n                Enter the 3-digit security code found on the back of your card.\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          \x3c!-- Submit Button --\x3e\r\n          <button\r\n            type="submit"\r\n            aria-label="Register"\r\n            class="btn btn-primary w-full"\r\n          >\r\n            Submit\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <span id="error" class="error" role="alert"></span>\r\n</section>\r\n\r\n\x3c!-- Modal container for ModalService --\x3e\r\n<div id="cardReaderModalContainer"></div>\r\n\r\n',"./store-card/store-card.template.html":'<div class="mx-auto max-w-screen-xl px-4 2xl:px-0 transition-transform duration-300 hover:scale-105 hover:shadow-lg cursor-pointer" id="id-{storeId}">\r\n  <div class="mx-auto max-w-5xl">\r\n    <div class="mt-6 sm:mt-8 lg:flex lg:items-start lg:gap-12">\r\n      <div class="border p-6 rounded-lg shadow-md w-full">\r\n        <h2 class="text-lg font-semibold mb-4 text-navy-blue">\r\n          Store Details\r\n        </h2>\r\n\r\n        <div class="mb-4 grid grid-cols-1 sm:grid-cols-2 gap-4">\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Store Name</p>\r\n            <p class="text-base font-semibold text-gray-900">{storeName}</p>\r\n          </div>\r\n          \x3c!-- <div>\r\n            <p class="text-sm font-medium text-gray-600">Store ID</p>\r\n            <p class="text-base font-semibold text-gray-900">{storeId}</p>\r\n          </div> --\x3e\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Store Number</p>\r\n            <p class="text-base font-semibold text-gray-900">{storeNumber}</p>\r\n          </div>\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Fuel Brand</p>\r\n            <p class="text-base font-semibold text-gray-900">{fuelBrand}</p>\r\n          </div>\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Phone</p>\r\n            <p class="text-base font-semibold text-gray-900">{phone}</p>\r\n          </div>\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Number of Pumps</p>\r\n            <p class="text-base font-semibold text-gray-900">{numberOfPumps}</p>\r\n          </div>\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Online Status</p>\r\n            <p class="text-base font-semibold text-green-600">\r\n              {isOnline}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div class="mt-4 border-t pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Address</p>\r\n            <p class="text-base font-semibold text-gray-900">\r\n              {streetAddress}, {city}, {stateCode}\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p class="text-sm font-medium text-gray-600">Geo Location</p>\r\n            <p class="text-base font-semibold text-gray-900">\r\n              Lat: {latitude}, Long: {longitude}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n',"./stores/stores.template.html":'<section class="container py-8">\r\n  <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">\r\n    <h1 class="text-2xl font-bold mb-6 text-navy-blue">Available Stores</h1>\r\n\r\n    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">\r\n      \x3c!-- Loop through stores and render store-card --\x3e\r\n     \r\n        {stores}\r\n      </div>\r\n      \r\n     \r\n    </div>\r\n  </section>\r\n  '})}}class CardReaderComponent extends BaseComponent{constructor(e,t,r,n){super(e),__publicField(this,"videoElement"),__publicField(this,"cardReaderContainer"),__publicField(this,"processingIndicator"),__publicField(this,"cameraErrorElement"),__publicField(this,"scanErrorMessage"),__publicField(this,"stream",null),__publicField(this,"canvas"),__publicField(this,"extractedCardNumber",""),__publicField(this,"extractedExpirationDate",""),__publicField(this,"cardholderName",""),__publicField(this,"cvv",""),__publicField(this,"onCardDataExtracted"),__publicField(this,"onManualEntry"),__publicField(this,"boundHandleVideoClick",null),__publicField(this,"captureIntervalId",null),__publicField(this,"isProcessing",!1),__publicField(this,"isClosed",!1),__publicField(this,"mode","auto"),__publicField(this,"captureIntervalMs",Number("300")||300),this.onCardDataExtracted=t,this.onManualEntry=r,this.canvas=document.createElement("canvas"),(null==n?void 0:n.mode)&&(this.mode=n.mode),(null==n?void 0:n.intervalMs)&&(this.captureIntervalMs=n.intervalMs)}async init(){this.isClosed=!1,this.isProcessing=!1,this.initializeElements(),this.setupEventListeners();try{if(await this.initCamera(),!this.stream)throw new Error("Camera stream not available");await this.waitForVideoReady()}catch(e){return}"auto"===this.mode&&this.startAutoCapture()}clean(){this.stopAutoCapture(),this.stopCameraStream(),this.removeEventListeners(),this.resetState(),this.isClosed=!0,this.isProcessing=!1}initializeElements(){this.videoElement=this.$("#camera-feed"),this.cardReaderContainer=this.$(".card-scanner-fullscreen"),this.processingIndicator=this.$("#processing-indicator"),this.cameraErrorElement=this.$("#camera-error"),this.scanErrorMessage=this.$("#scan-error-message")}setupEventListeners(){this.boundHandleVideoClick=this.handleVideoClick.bind(this);const e=this.$(".camera-viewport");e&&e.addEventListener("click",this.boundHandleVideoClick);const t=this.$(".card-scanner-fullscreen");t&&t.addEventListener("click",(async e=>{var t;if("manual"!==this.mode)return;const r=e.target,n="close-scanner"===r.id||!!r.closest&&!!r.closest("#close-scanner"),s=(null==(t=r.classList)?void 0:t.contains("manual-entry-text"))||!!r.closest&&!!r.closest(".manual-entry-text");n||s||await this.captureAndProcess("manual")}));const r=this.$(".manual-entry-text");r&&r.addEventListener("click",(()=>{this.onManualEntry&&this.onManualEntry()}));const n=this.$("#close-scanner");n&&n.addEventListener("click",(()=>{this.close()}))}removeEventListeners(){if(this.boundHandleVideoClick){const e=this.$(".camera-viewport");e&&e.removeEventListener("click",this.boundHandleVideoClick),this.boundHandleVideoClick=null}}async initCamera(){try{this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1}),this.videoElement.srcObject=this.stream,this.hideElement(this.cameraErrorElement)}catch(e){this.showElement(this.cameraErrorElement)}}async waitForVideoReady(){this.videoElement.readyState>=2&&this.videoElement.videoWidth>0||await new Promise(((e,t)=>{const onLoaded=()=>{e(),this.videoElement.removeEventListener("loadedmetadata",onLoaded),this.videoElement.removeEventListener("loadeddata",onLoaded),this.videoElement.removeEventListener("playing",onLoaded),this.videoElement.removeEventListener("error",onError)},onError=e=>{this.videoElement.removeEventListener("error",onError),this.videoElement.removeEventListener("loadedmetadata",onLoaded),this.videoElement.removeEventListener("loadeddata",onLoaded),this.videoElement.removeEventListener("playing",onLoaded),t(new Error("Video failed to load"))};this.videoElement.addEventListener("loadedmetadata",onLoaded),this.videoElement.addEventListener("loadeddata",onLoaded),this.videoElement.addEventListener("playing",onLoaded),this.videoElement.addEventListener("error",onError)}))}startAutoCapture(){this.stopAutoCapture(),(async()=>{this.isClosed||this.isProcessing||await this.captureAndProcess("auto")})(),this.captureIntervalId=window.setInterval((async()=>{this.isClosed||this.isProcessing||await this.captureAndProcess("auto")}),this.captureIntervalMs)}stopAutoCapture(){null!==this.captureIntervalId&&(window.clearInterval(this.captureIntervalId),this.captureIntervalId=null)}async handleVideoClick(){"manual"===this.mode?await this.captureAndProcess("manual"):this.isProcessing||await this.captureAndProcess("auto")}stopCameraStream(){var e;null==(e=this.stream)||e.getTracks().forEach((e=>e.stop())),this.stream=null}resetState(){this.extractedCardNumber="",this.extractedExpirationDate="",this.cardholderName="",this.cvv="",this.hideElement(this.scanErrorMessage),this.hideElement(this.processingIndicator)}captureCurrentFrame(){if(!this.stream)return null;const{videoWidth:e,videoHeight:t}=this.videoElement;if(!e||!t)return null;this.canvas.width=e,this.canvas.height=t;const r=this.canvas.getContext("2d");return r?(r.drawImage(this.videoElement,0,0,e,t),this.canvas.toDataURL("image/jpeg",.8)):null}async captureAndProcess(e){try{this.isProcessing=!0,"manual"===e&&this.showElement(this.processingIndicator),this.hideElement(this.scanErrorMessage);const t=this.captureCurrentFrame();if(!t)return void this.handleProcessingError("Unable to capture image");const r=await this.apiService.getCardInfo(t);this.extractedCardNumber=r.cardNumber||"",this.extractedExpirationDate=r.expDate||"",this.cardholderName=r.cardholderName||"",this.cvv=r.cvv||"","auto"===e?this.extractedCardNumber&&this.acceptResults():this.acceptResults()}catch(t){this.handleProcessingError("Error processing card image")}finally{this.isProcessing=!1,"manual"===e&&this.hideElement(this.processingIndicator)}}handleProcessingError(e){this.scanErrorMessage.textContent=e,this.showElement(this.scanErrorMessage)}acceptResults(){this.onCardDataExtracted(this.extractedCardNumber,this.extractedExpirationDate,this.cardholderName,this.cvv)}getCardData(){return this.extractedCardNumber&&this.extractedExpirationDate?{cardNumber:this.extractedCardNumber,expirationDate:this.extractedExpirationDate,cardholderName:this.cardholderName,cvv:this.cvv}:null}reset(){this.resetState(),"auto"===this.mode&&this.startAutoCapture()}close(){this.clean(),this.cardReaderContainer&&this.cardReaderContainer.remove()}showElement(e){e.classList.remove("hidden"),e.classList.add("flex")}hideElement(e){e.classList.add("hidden"),e.classList.remove("flex")}}const V=class _GlobalErrorHandlerService{constructor(){__publicField(this,"notificationService"),__publicField(this,"isInitialized",!1),__publicField(this,"handleError",(e=>{var t,r;let n;n=e instanceof ErrorEvent?(null==(t=e.error)?void 0:t.message)||e.message||"An unexpected error occurred":(null==(r=e.reason)?void 0:r.message)||e.reason||"An unhandled promise rejection occurred",this.notificationService.push("error",n,8e3)})),this.notificationService=o.getInstance()}static getInstance(){return _GlobalErrorHandlerService.instance||(_GlobalErrorHandlerService.instance=new _GlobalErrorHandlerService),_GlobalErrorHandlerService.instance}static getErrorMessage(e,t="",r="unknown error"){let n;return n=e?"string"==typeof e?e:e instanceof Error||"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:JSON.stringify(e):r,`${t}${n}`}static isWrongCredentialsError(e){return e instanceof ApiError&&e.statusCode===r.WRONG_CREDENTIALS}initialize(){this.isInitialized||(window.addEventListener("error",(e=>{var t;const r=(null==(t=e.error)?void 0:t.message)||e.message||"An unexpected error occurred";this.notificationService.push("error",r,8e3)})),window.addEventListener("unhandledrejection",(e=>{var t;const r=(null==(t=e.reason)?void 0:t.message)||e.reason||"An unhandled promise rejection occurred";this.notificationService.push("error",r,8e3)})),this.isInitialized=!0)}destroy(){this.isInitialized&&(window.removeEventListener("error",this.handleError),window.removeEventListener("unhandledrejection",this.handleError),this.isInitialized=!1)}};__publicField(V,"instance");let U=V;class ModalService{constructor(e,t){__publicField(this,"modalsState",{}),__publicField(this,"onToggleCallback"),this.getModalTemplate=e,this.onToggleCallback=t}toggleModal(e){if(e in this.modalsState||(this.modalsState[e]=!1),this.modalsState[e]=!this.modalsState[e],this.updateModalUI(e),this.onToggleCallback){const t=this.modalsState[e]?"open":"close";this.onToggleCallback(e,t)}}updateModalUI(e){const t=document.getElementById(`${e}Container`);t&&(t.innerHTML="",t.innerHTML=this.modalsState[e]?this.getModalTemplate(e):"",this.attachModalEvent(e))}attachModalEvent(e){var t;null==(t=document.getElementById(`${e}Close`))||t.addEventListener("click",(()=>{this.modalsState[e]=!1,this.updateModalUI(e),this.onToggleCallback&&this.onToggleCallback(e,"close")}))}}class RegisterFormComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"form"),__publicField(this,"errorSpan"),__publicField(this,"cardNumberInput"),__publicField(this,"expInput"),__publicField(this,"cvvInput"),__publicField(this,"phoneInput"),__publicField(this,"scanCardBtn"),__publicField(this,"cardReaderContent"),__publicField(this,"numberOfPumps"),__publicField(this,"resetPassword",!1),__publicField(this,"cardReaderComponent"),__publicField(this,"modalService"),this.numberOfPumps=this.state.numberOfPumps,this.cardReaderComponent=new CardReaderComponent(this.store,this.onCardDataExtracted.bind(this),(()=>{this.cardReaderComponent.close(),this.modalService.toggleModal("cardReaderModal")})),this.modalService=new ModalService(this.getModalTemplate.bind(this),this.handleModalToggle.bind(this))}onCardDataExtracted(e,t,r,n){this.cardReaderComponent.close(),this.modalService.toggleModal("cardReaderModal"),this.cardNumberInput.value=e,this.expInput.value=t,this.cvvInput.value=n,this.handleCardNumberInput()}attachEventsInternal(){this.form=this.$("form"),this.errorSpan=this.$("#error"),this.cardNumberInput=this.$("#card-number-input"),this.expInput=this.$("#card-expiration-input"),this.phoneInput=this.$("#mobile-phone-input"),this.scanCardBtn=this.$("#scan-card-btn"),this.cvvInput=this.$("#cvv-input"),this.populatePumpDropdown(),this.preventNonNumericValues(this.form,["#card-number-input","#zipcode","#cvv-input","#mobile-phone-input"]),this.setupInputFormatting(),this.form.addEventListener("submit",(e=>this.handleSubmit(e))),this.scanCardBtn.addEventListener("click",(()=>this.handleScanCardClick()))}handleModalToggle(e,t){"cardReaderModal"===e&&("open"===t?(this.cardReaderContent=this.$("#card-reader-content"),this.cardReaderContent&&(this.cardReaderContent.innerHTML=this.cardReaderComponent.render(),this.cardReaderComponent.init())):"close"===t&&(this.cardReaderContent=null))}handleScanCardClick(){this.modalService.toggleModal("cardReaderModal")}getModalTemplate(e){return"cardReaderModal"===e?'<div id="card-reader-content"></div>':""}populatePumpDropdown(){const e=this.$("#pump-number");e.innerHTML="";for(let t=1;t<=this.numberOfPumps;t++){const r=document.createElement("option");r.value=t.toString(),r.textContent=`Pump ${t}`,e.appendChild(r)}}validate(e){return validate(B,e)}async handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.errorSpan.innerHTML="";const r=this.getFormData(),n=this.validate(r);if(Object.keys(n).length>0)this.errorSpan.innerHTML=Object.values(n).flat().map((e=>"<div>"+e+"</div>")).join("");else{this.displayLoading();try{const{phone:e,creditCard:n,...s}=r,{_id:a}=await this.apiService.registerCustomer(e,n,Object.keys(s).length?s:void 0,this.resetPassword);this.store.setState({...r,customerId:a,phone:r.phone,chosenPumpNumber:Number(this.$("#pump-number").value??0)}),this.store.transitionTo(t.IN_OTP_FORM)}catch(s){U.isWrongCredentialsError(s)?this.errorSpan.textContent="You are using wrong credentials you can reset your password":this.errorSpan.textContent=U.getErrorMessage(s)}finally{this.hideLoading()}}}getFormData(){return{phone:this.phoneInput.value,creditCard:{cardNumber:this.cardNumberInput.value.replace(/\s/g,""),exp:this.expInput.value,zipCode:this.$("#zipcode").value,cvv:this.$("#cvv-input").value}}}setupInputFormatting(){this.cardNumberInput.addEventListener("input",(()=>this.handleCardNumberInput())),this.expInput.addEventListener("input",(()=>this.handleExpInput()))}handleCardNumberInput(){const e=this.cardNumberInput.value.replace(/\D/g,"").slice(0,16);this.cardNumberInput.value=e.replace(/(\d{4})(?=\d)/g,"$1 ").trim()}handleExpInput(){const e=this.expInput.value.replace(/\D/g,"").slice(0,4);this.expInput.value=e.length>=3?`${e.slice(0,2)}/${e.slice(2)}`:e}}var q=(e=>(e.DEFAULT="default",e.FULL="full",e.LOGIN="login",e))(q||{});const W={[q.DEFAULT]:t.REGISTER_FORM,[q.FULL]:t.REGISTER_EXTENDED_FORM,[q.LOGIN]:t.LOGIN_FORM};class StoreCardComponent extends PageBaseComponent{constructor(e,t={}){super(e),__publicField(this,"card"),this.storeData=t}templateData(){var e,t,r,n,s,a,i,o,d,l,c;return{...this.storeData,streetAddress:(null==(t=null==(e=this.storeData)?void 0:e.address)?void 0:t.streetAddress)||"unkown street",city:(null==(n=null==(r=this.storeData)?void 0:r.address)?void 0:n.city)||"unkown city",stateCode:(null==(a=null==(s=this.storeData)?void 0:s.address)?void 0:a.stateCode)||"unkown state",latitude:(null==(o=null==(i=this.storeData)?void 0:i.geoLocation)?void 0:o.latitude)||"00",longitude:(null==(l=null==(d=this.storeData)?void 0:d.geoLocation)?void 0:l.longitude)||"00",isOnline:(null==(c=this.storeData)?void 0:c.isOnline)?"Online":"Offline"}}attachEventsInternal(){this.card=this.$(`#id-${this.storeData.storeId}`),this.card.addEventListener("click",(()=>this.handleCardClick()))}handleCardClick(){this.store.setState({chosenStoreId:this.storeData.storeId??"",chosenStorePosition:this.storeData.geoLocation,numberOfPumps:this.storeData.numberOfPumps??0});const e=function(){const e=new URLSearchParams(window.location.search).get("mode")||q.DEFAULT;return Object.values(q).includes(e)?e:q.DEFAULT}();this.store.transitionTo(W[e])}}class StoresComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"stores",[]),__publicField(this,"cardsComponents",[]),this.stores=this.state.stores,this.cardsComponents=this.stores.map((e=>new StoreCardComponent(this.store,e)))}getStoreCards(){return this.cardsComponents.map((e=>e.render())).join("")}templateData(){return{stores:this.getStoreCards()}}attachEventsInternal(){this.cardsComponents.forEach((e=>{e.attachEvents()}))}}const H=B.extend({firstName:M().min(1,{message:"First name is required"}).refine((e=>/^[A-Za-z]+$/.test(e)),{message:"First name must contain only letters"}),lastName:M().min(1,{message:"Last name is required"}).refine((e=>/^[A-Za-z]+$/.test(e)),{message:"Last name must contain only letters"}),email:M().min(1,{message:"Email is required"}).email({message:"Email must be a valid email address"}),password:M().min(8,{message:"Password must be at least 8 characters long, contain at least one letter and one number, and have no spaces"}).regex(/^(?=.*[a-zA-Z])(?=.*\d)[^\s]{8,}$/,{message:"Password must be at least 8 characters long, contain at least one letter and one number, and have no spaces"}),pinCode:M().length(4,{message:"PIN code must be a 4-digit number"}).refine((e=>/^\d+$/.test(e)),{message:"PIN code must contain only digits"})}),K=F({email:M().min(1,{message:"Email is required"}).email({message:"Email must be a valid email address"})});class ExtendedRegisterFormComponent extends RegisterFormComponent{constructor(e){super(e),__publicField(this,"firstNameInput"),__publicField(this,"lastNameInput"),__publicField(this,"emailInput"),__publicField(this,"passwordInput"),__publicField(this,"pinCodeInput"),__publicField(this,"resetPasswordButton"),__publicField(this,"passwordLabel"),__publicField(this,"passwordDescription")}attachEventsInternal(){super.attachEventsInternal(),this.firstNameInput=this.$("#first-name"),this.lastNameInput=this.$("#last-name"),this.emailInput=this.$("#email"),this.passwordInput=this.$("#password"),this.pinCodeInput=this.$("#pin-code"),this.resetPasswordButton=this.$("#reset-password-button"),this.passwordLabel=this.$("#password-label"),this.passwordDescription=this.$("#password-description"),this.resetPasswordButton.addEventListener("click",(()=>this.handleResetPasswordButtonClick())),this.preventNonNumericValues(this.form,["#pin-code"])}validate(e){return validate(H,e)}async handleResetPasswordButtonClick(){this.errorSpan.innerHTML="";try{const e=this.getFormData(),t=validate(K,{email:e.email});if(Object.keys(t).length>0)return void(this.errorSpan.innerHTML=Object.values(t).flat().map((e=>"<div>"+e+"</div>")).join(""));this.displayLoading(),await this.apiService.resetPassword(e.email),this.resetPassword=!0,this.passwordLabel.textContent="Password or Reset Link*",this.passwordDescription.textContent="Please enter your password or the password reset link that was just emailed to you.",this.passwordInput.type="text"}catch(e){this.errorSpan.textContent=U.getErrorMessage(e)}finally{this.hideLoading()}}getFormData(){return{...super.getFormData(),firstName:this.firstNameInput.value.trim(),lastName:this.lastNameInput.value.trim(),email:this.emailInput.value.trim(),password:this.passwordInput.value,pinCode:this.pinCodeInput.value}}}class OtpFormComponent extends PageBaseComponent{constructor(){super(...arguments),__publicField(this,"inputs"),__publicField(this,"errorSpan"),__publicField(this,"form")}attachEventsInternal(){this.inputs=this.$_all('input[name^="otp"]'),this.errorSpan=this.$("#error"),this.form=this.$("form"),this.inputs.forEach(((e,t)=>{e.addEventListener("input",(()=>this.handleInput(e,t))),e.addEventListener("keydown",(e=>this.handleBackspace(e,t))),e.addEventListener("paste",(e=>this.handlePaste(e)))})),this.form.addEventListener("submit",(e=>this.handleSubmit(e)))}handleInput(e,t){e.value=e.value.slice(0,1);const r=this.inputs[t+1];e.value&&r&&r.focus()}handleBackspace(e,t){const r=e.target;if("Backspace"===e.key){if(""===r.value){const e=this.inputs[t-1];e&&e.focus()}else r.value="";e.preventDefault()}}handlePaste(e){var t;e.preventDefault();const r=((null==(t=e.clipboardData)?void 0:t.getData("text"))||"").replace(/\D/g,"").split("");r.length===this.inputs.length&&this.inputs.forEach(((e,t)=>e.value=r[t]||""))}async handleSubmit(e){e.preventDefault(),this.errorSpan.innerHTML="";const r=this.getFormData();if(r.length===this.inputs.length)try{await this.apiService.verifySmsToken(this.state.customerId,r,{position:this.state.chosenStorePosition||this.state.position,storeId:this.state.chosenStoreId,pumpNumber:this.state.chosenPumpNumber}),this.store.transitionTo(t.FINAL)}catch(n){this.errorSpan.textContent=U.getErrorMessage(n)}else this.errorSpan.innerHTML="OTP must be 6 digits"}getFormData(){return Array.from(this.inputs).map((e=>e.value)).join("")}}class CanceledComponent extends BaseComponent{constructor(e,t){super(e),__publicField(this,"message"),this.message=t}templateData(){return{message:this.message}}}class ErrorComponent extends CanceledComponent{buildTemplatePath(){return"./canceled/canceled.template.html"}}class FinalComponent extends PageBaseComponent{}const G=F({phone:M().length(10,{message:"Phone number must be a numeric value with 10 digits"}).refine((e=>/^\d+$/.test(e)),{message:"Phone number must contain only digits"}),pumpNumber:D({message:"Pump number must be a positive"}).min(1)});class LoginFormComponent extends PageBaseComponent{constructor(e){super(e),__publicField(this,"form"),__publicField(this,"errorSpan"),__publicField(this,"phoneInput"),__publicField(this,"pumpDropdown"),__publicField(this,"numberOfPumps"),this.numberOfPumps=this.state.numberOfPumps}attachEvents(){this.form=this.$("form"),this.errorSpan=this.$("#error"),this.phoneInput=this.$("#mobile-phone-input"),this.pumpDropdown=this.$("#pump-number"),this.populatePumpDropdown(),this.preventNonNumericValues(this.form,["#mobile-phone-input"]),this.form.addEventListener("submit",(e=>this.handleSubmit(e)))}populatePumpDropdown(){this.pumpDropdown.innerHTML="";for(let e=1;e<=this.numberOfPumps;e++){const t=document.createElement("option");t.value=e.toString(),t.textContent=`Pump ${e}`,this.pumpDropdown.appendChild(t)}}async handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.errorSpan.textContent="";const r=this.getFormData(),n=validate(G,r);if(Object.keys(n).length>0)this.errorSpan.textContent=Object.values(n)[0][0];else try{const{_id:e,success:n}=await this.apiService.loginCustomer({...r,...this.state.position,storeId:this.state.chosenStoreId});if(n)return void this.store.transitionTo(t.FINAL);this.store.setState({phone:r.phone,customerId:e,chosenPumpNumber:r.pumpNumber}),this.store.transitionTo(t.IN_OTP_FORM)}catch(s){this.errorSpan.textContent=(null==s?void 0:s.message)||s}}getFormData(){return{phone:this.phoneInput.value,pumpNumber:Number(this.pumpDropdown.value)}}}class Renderer{constructor(e){__publicField(this,"appElement"),__publicField(this,"currentComponent",null),__publicField(this,"messages",{cancel:"Please see an attendant inside to pay for fuel",error:"Something went wrong, please see an attendant inside to pay for fuel"}),this.componentFactory=e,this.appElement=document.getElementById("app"),o.getInstance()}update(e,t){this.appElement&&(this.currentComponent=this.componentFactory(e.state,t),this.appElement.innerHTML=this.currentComponent.render(),this.currentComponent.attachEvents())}}class Store{constructor(e,t,r,n){__publicField(this,"subscriber",null),__publicField(this,"OTP_COOKIE_KEY","otpState"),__publicField(this,"storeCookieStates"),__publicField(this,"deleteCookieState"),__publicField(this,"excludeFromCookie"),__publicField(this,"initialState"),__publicField(this,"state"),this.initialState=e,this.state=this.initialState,this.storeCookieStates=t,this.deleteCookieState=r,this.excludeFromCookie=n,this.loadStoredState()}getState(){return this.state}setState(e){this.state={...this.state,...e}}transitionTo(e){this.state.state=e,this.storeCookieStates.includes(e)?this.storeOtpState():e===this.deleteCookieState&&this.deleteStoredState(),this.notifySubscriber()}storeOtpState(){const e=(t=this.state,r=this.excludeFromCookie,Object.fromEntries(Object.entries(t).filter((([e])=>!r.includes(e)))));var t,r;const n="https:"===window.location.protocol;document.cookie=`${this.OTP_COOKIE_KEY}=${encodeURIComponent(JSON.stringify(e))};path=/;max-age=120${n?";secure":""}`}subscribe(e){this.subscriber=e}notifySubscriber(){this.subscriber&&this.subscriber.update(this.state,this)}setInitialState(){this.setState(this.initialState)}loadStoredState(){const e=this.getCookie(this.OTP_COOKIE_KEY);if(e)try{const t=JSON.parse(decodeURIComponent(e));this.state={...this.initialState,...t},this.notifySubscriber()}catch{this.state=this.initialState}}deleteStoredState(){document.cookie=`${this.OTP_COOKIE_KEY}=;path=/;max-age=0;`}getCookie(e){const t=document.cookie.match(new RegExp(`(^| )${e}=([^;]+)`));return t?t[2]:null}}const Y={state:t.INITIAL,position:{longitude:"",latitude:""},stores:[],chosenStoreId:"",chosenStorePosition:{latitude:"",longitude:""},numberOfPumps:0,chosenPumpNumber:0,creditCard:{cardNumber:"",exp:"",zipCode:"",cvv:""},phone:"",customerId:""};window.addEventListener("load",(async function(){U.getInstance().initialize();const e=new ApiService,r=new Store(Y,[t.IN_OTP_FORM],t.FINAL,["creditCard","stores"]),n=new Renderer(function(){const e={[t.INITIAL]:e=>new InitialComponent(e),[t.REGISTER_FORM]:e=>new RegisterFormComponent(e),[t.STORES_PAGE]:e=>new StoresComponent(e),[t.REGISTER_EXTENDED_FORM]:e=>new ExtendedRegisterFormComponent(e),[t.LOGIN_FORM]:e=>new LoginFormComponent(e),[t.IN_OTP_FORM]:e=>new OtpFormComponent(e),[t.ERROR]:e=>new ErrorComponent(e,"Something went wrong, please see an attendant inside to pay for fuel"),[t.FINAL]:e=>new FinalComponent(e)};return(r,n)=>e[r]?e[r](n):e[t.ERROR](n)}());r.subscribe(n);const s=l.getInstance();s.show();const a=r.getState().state;if(a!==t.INITIAL)return r.transitionTo(a),void s.hide();async function getStores(n){try{s.show();const{data:a}=await e.listStores(n);r.setState({stores:a??[]}),r.transitionTo(t.STORES_PAGE)}catch(a){o.getInstance().push("error","Failed to load stores. Please try again."+U.getErrorMessage(a))}finally{s.hide()}}try{navigator.geolocation.getCurrentPosition((async function(e){r.setState({position:{longitude:`${e.coords.longitude}`,latitude:`${e.coords.latitude}`}}),r.transitionTo(t.INITIAL),await getStores(r.getState().position)}),(async function(){r.setState({position:{longitude:"28.186879730583183",latitude:"-82.40479285767222"}}),r.transitionTo(t.INITIAL),await getStores(r.getState().position)}))}catch(i){o.getInstance().push("error",U.getErrorMessage(i)),s.hide()}}));
